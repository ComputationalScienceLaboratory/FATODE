MODULE cbm4_Parameters
    INTEGER, PARAMETER :: NVAR = 32
    INTEGER, PARAMETER :: NNZ = 19
    INTEGER, PARAMETER :: NREACT=81, NFIX=1
    INTEGER, PARAMETER :: NHESS = 258 
    ! NJVRP - Length of sparse Jacobian JVRP
    INTEGER, PARAMETER :: NJVRP = 134

    ! RCONST - Rate constants (local)
    DOUBLE PRECISION :: RCONST(NREACT)
   ! FIX - Concentrations of fixed species 
    DOUBLE PRECISION :: FIX(NFIX)
    DOUBLE PRECISION :: SUN
    ! Temperature
    DOUBLE PRECISION :: TEMP
    ! Row-compressed sparse data for the Jacobian of reaction products JVRP
    ! Hessian
    DOUBLE PRECISION :: HESS(NHESS)

    INTEGER, PARAMETER, DIMENSION(82) :: CROW_JVRP = (/ &
       1,  2,  3,  5,  7,  9, 11, 13, 14, 15, 16, 17, &
      19, 21, 22, 24, 26, 28, 29, 30, 31, 33, 35, 36, &
      38, 39, 41, 43, 45, 47, 48, 50, 51, 52, 53, 55, &
      57, 59, 60, 61, 63, 65, 67, 69, 71, 72, 74, 76, &
      77, 78, 80, 81, 83, 84, 85, 87, 89, 91, 93, 95, &
      97, 99,101,103,105,106,108,110,112,114,116,117, &
     119,121,122,124,126,128,130,132,133,135 /)

    INTEGER, PARAMETER, DIMENSION(134) :: ICOL_JVRP = (/ &
      26, 29, 25, 31, 26, 29, 26, 29, 29, 31, 25, 26, &
      25, 25,  1,  1, 25, 27, 25, 28, 30, 30, 31, 26, &
      30, 26, 30,  6,  6, 31, 26, 31, 27, 31,  9,  9, &
      27,  9, 26, 27, 12, 27, 28, 31, 26, 28, 10, 10, &
      27, 28, 28,  2,  2, 27, 16, 27, 21, 27, 21, 21, &
      21, 29, 21, 30, 24, 29, 24, 27, 24, 30, 24, 31, &
      32, 26, 32,  3, 32, 28, 32, 27, 20, 27, 13, 13, &
      13, 26, 23, 29, 23, 27, 23, 25, 23, 30, 17, 29, &
      17, 27, 17, 25,  5, 27, 11, 31, 11, 14, 27, 14, &
      30,  4, 26,  7, 27, 19, 27, 19, 19, 25, 15, 27, &
      15, 22, 29, 22, 27, 22, 25, 22, 30, 18, 31, 18, &
       8, 31 /)
    !  Stoichiometric Matrix in Compressed Column Sparse Format


    INTEGER, PARAMETER, DIMENSION(82) :: CCOL_STOICM = (/ &
       1,  4,  6,  9, 12, 15, 18, 21, 23, 25, 27, 29, &
      32, 35, 39, 42, 44, 47, 49, 52, 54, 57, 60, 63, &
      66, 69, 72, 75, 79, 82, 85, 88, 90, 92, 94, 97, &
     100,104,107,109,114,119,123,126,130,135,141,144, &
     147,151,156,160,167,173,175,177,187,194,203,211, &
     218,224,229,235,240,243,249,253,255,263,270,274, &
     284,288,292,301,311,321,324,327,328,330 /)

    INTEGER, PARAMETER, DIMENSION(329) :: IROW_STOICM = (/ &
      26, 29, 31, 25, 29, 25, 26, 31, 26, 29, 31, 26, &
      29, 30, 26, 29, 31, 25, 26, 30, 25, 29,  1, 25, &
       1, 29,  1, 27, 25, 27, 28, 25, 27, 28, 26, 29, &
      30, 31, 26, 30, 31, 30, 31,  6, 26, 30,  6, 12, &
       6, 26, 30, 26, 31,  9, 26, 31,  9, 27, 31,  9, &
      27, 31,  9, 26, 27,  9, 26, 31, 12, 26, 27, 12, &
      27, 30, 26, 27, 28, 31, 10, 26, 28, 10, 26, 28, &
      10, 26, 27,  2, 28,  2, 28,  2, 27,  2, 27, 28, &
      16, 27, 28, 16, 21, 27, 28, 16, 21, 28, 16, 21, &
      16, 21, 27, 28, 29, 12, 16, 21, 28, 30, 24, 27, &
      29, 32, 24, 27, 32, 12, 24, 30, 32, 16, 18, 21, &
      24, 28, 18, 21, 26, 28, 31, 32,  3, 26, 32,  3, &
      26, 32, 18, 21, 28, 32, 18, 21, 27, 28, 32, 18, &
      21, 27, 28,  8, 13, 18, 20, 24, 27, 28,  8, 13, &
      18, 20, 24, 28, 13, 28, 13, 26,  8, 16, 18, 20, &
      21, 23, 24, 27, 28, 29, 18, 20, 21, 23, 24, 27, &
      28, 16, 18, 20, 21, 23, 24, 25, 27, 28,  8, 18, &
      20, 21, 23, 24, 26, 30, 16, 17, 18, 21, 27, 28, &
      29, 17, 18, 21, 24, 27, 28, 16, 17, 21, 25, 28, &
       5, 11, 14, 18, 27, 28, 11, 19, 26, 28, 31, 11, &
      14, 28,  4, 14, 18, 19, 27, 28,  4, 12, 14, 30, &
       4, 26,  7, 11, 14, 15, 18, 20, 27, 28, 16, 18, &
      19, 21, 27, 28, 32, 16, 19, 28, 32, 15, 16, 18, &
      19, 21, 24, 25, 27, 28, 32, 15, 18, 27, 32, 15, &
      16, 28, 32, 16, 17, 18, 20, 22, 23, 24, 28, 29, &
       8, 15, 17, 18, 21, 22, 24, 27, 28, 32, 15, 16, &
      17, 20, 21, 22, 24, 25, 27, 28,  8, 22, 30, 18, &
      26, 31, 18,  8, 31 /)

    INTEGER, PARAMETER, DIMENSION(329) :: ICOL_STOICM = (/ &
       1,  1,  1,  2,  2,  3,  3,  3,  4,  4,  4,  5, &
       5,  5,  6,  6,  6,  7,  7,  7,  8,  8,  9,  9, &
      10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 14, 14, &
      14, 14, 15, 15, 15, 16, 16, 17, 17, 17, 18, 18, &
      19, 19, 19, 20, 20, 21, 21, 21, 22, 22, 22, 23, &
      23, 23, 24, 24, 24, 25, 25, 25, 26, 26, 26, 27, &
      27, 27, 28, 28, 28, 28, 29, 29, 29, 30, 30, 30, &
      31, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 35, &
      36, 36, 36, 37, 37, 37, 37, 38, 38, 38, 39, 39, &
      40, 40, 40, 40, 40, 41, 41, 41, 41, 41, 42, 42, &
      42, 42, 43, 43, 43, 44, 44, 44, 44, 45, 45, 45, &
      45, 45, 46, 46, 46, 46, 46, 46, 47, 47, 47, 48, &
      48, 48, 49, 49, 49, 49, 50, 50, 50, 50, 50, 51, &
      51, 51, 51, 52, 52, 52, 52, 52, 52, 52, 53, 53, &
      53, 53, 53, 53, 54, 54, 55, 55, 56, 56, 56, 56, &
      56, 56, 56, 56, 56, 56, 57, 57, 57, 57, 57, 57, &
      57, 58, 58, 58, 58, 58, 58, 58, 58, 58, 59, 59, &
      59, 59, 59, 59, 59, 59, 60, 60, 60, 60, 60, 60, &
      60, 61, 61, 61, 61, 61, 61, 62, 62, 62, 62, 62, &
      63, 63, 63, 63, 63, 63, 64, 64, 64, 64, 64, 65, &
      65, 65, 66, 66, 66, 66, 66, 66, 67, 67, 67, 67, &
      68, 68, 69, 69, 69, 69, 69, 69, 69, 69, 70, 70, &
      70, 70, 70, 70, 70, 71, 71, 71, 71, 72, 72, 72, &
      72, 72, 72, 72, 72, 72, 72, 73, 73, 73, 73, 74, &
      74, 74, 74, 75, 75, 75, 75, 75, 75, 75, 75, 75, &
      76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 77, 77, &
      77, 77, 77, 77, 77, 77, 77, 77, 78, 78, 78, 79, &
      79, 79, 80, 81, 81 /)

    DOUBLE PRECISION, PARAMETER, DIMENSION(150) :: STOICM_0 = (/ &
      -1.000000e+00,  1.000000e+00,  1.000000e+00,  1.000000e+00, -1.000000e+00, &
      -1.000000e+00,  1.000000e+00,  -1.000000e+00,  -1.000000e+00, -1.000000e+00, &
      1.000000e+00,  -1.000000e+00,  -1.000000e+00,  1.000000e+00, 1.000000e+00, &
      -1.000000e+00,  -1.000000e+00,  -1.000000e+00, -1.000000e+00,  1.000000e+00, &
      -1.000000e+00,  1.000000e+00,  1.000000e+00,  -1.000000e+00, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  2.000000e+00,  -1.000000e+00, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  1.000000e+00,  -1.000000e+00, 8.900000e-01, &
       8.900000e-01,  -1.000000e+00,  1.100000e-01,  2.000000e+00, -1.000000e+00, &
       -1.000000e+00,  -1.000000e+00,  1.000000e+00,  1.000000e+00, -1.000000e+00, &
       -1.000000e+00,  -1.000000e+00,  2.000000e+00,  -1.000000e+00, 1.000000e+00, &
       1.000000e+00,  2.000000e+00,  -2.000000e+00,  2.000000e+00, -1.000000e+00, &
       -1.000000e+00,  1.000000e+00,  -1.000000e+00,  -1.000000e+00, -1.000000e+00, &
       1.000000e+00,  1.000000e+00,  -1.000000e+00,  1.000000e+00, -1.000000e+00, &
       -2.000000e+00,  1.000000e+00,  1.000000e+00,  1.000000e+00, -1.000000e+00, &
       -1.000000e+00,  -1.000000e+00,  -1.000000e+00,  1.000000e+00, 1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  -1.000000e+00,  1.000000e+00, -1.000000e+00, &
       -1.000000e+00,  -1.000000e+00,  1.000000e+00,  1.000000e+00, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  1.000000e+00,  -2.000000e+00, 1.000000e+00, &
       -2.000000e+00,  -1.000000e+00,  2.000000e+00,  -1.000000e+00, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  -1.000000e+00,  1.000000e+00, 1.000000e+00, &
       -1.000000e+00,  -1.000000e+00,  1.000000e+00,  1.000000e+00, -1.000000e+00, &
       2.000000e+00,  1.000000e+00,  -1.000000e+00,  1.000000e+00, -1.000000e+00, &
       1.000000e+00,  1.000000e+00,  -1.000000e+00,  1.000000e+00, 1.000000e+00, &
       -1.000000e+00,  1.000000e+00,  -1.000000e+00,  -1.000000e+00, 1.000000e+00, &
       -1.000000e+00,  1.000000e+00,  -1.000000e+00,  -1.000000e+00, 1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  -1.000000e+00,  1.000000e+00, 1.000000e+00, &
       1.000000e+00,  1.000000e+00,  -1.000000e+00,  2.000000e+00, 1.000000e+00, &
       1.000000e+00,  1.000000e+00,  1.000000e+00,  -1.000000e+00, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  -1.000000e+00,  -1.000000e+00, 1.000000e+00, &
       1.000000e+00,  2.000000e+00,  2.000000e+00,  2.000000e+00, -2.000000e+00 /)


     DOUBLE PRECISION, PARAMETER, DIMENSION(150) :: STOICM_1 = (/ &
       7.900000e-01,  7.900000e-01,  7.900000e-01,  -2.100000e-01, -1.000000e+00, &
       1.000000e+00,  1.000000e+00,  -1.000000e+00,  1.000000e+00, 1.300000e-01, &
       7.600000e-01,  8.700000e-01,  -1.110000e+00,  1.100000e-01, -1.000000e+00, &
       1.100000e-01,  4.000000e-02,  -9.800000e-01,  9.600000e-01, -2.100000e+00, &
       1.100000e+00,  9.400000e-01,  -1.000000e+00,  1.000000e+00, -1.000000e+00, &
       -1.000000e+00,  2.000000e-02,  3.000000e-01,  2.800000e-01, 2.200000e-01, &
       2.000000e-01,  -1.000000e+00,  6.300000e-01,  2.000000e-01, 3.800000e-01, &
       -1.000000e+00,  1.000000e+00,  -1.000000e+00,  1.000000e+00, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  1.000000e+00,  3.300000e-01, 2.200000e-01, &
       -1.000000e+00,  7.400000e-01,  -1.000000e+00,  5.000000e-01, -1.000000e+00, &
       1.000000e-01,  4.400000e-01,  9.000000e-02,  9.100000e-01, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  1.000000e+00,  1.000000e+00, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  7.000000e-01,  1.000000e+00, 3.000000e-01, &
       1.700000e+00,  -1.000000e+00,  -1.000000e+00,  1.000000e+00, 1.560000e+00, &
       2.200000e-01,  -1.000000e+00,  1.000000e+00,  4.200000e-01, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  1.200000e-01,  -1.000000e+00, 5.600000e-01, &
       3.600000e-01,  8.000000e-02,  -1.000000e+00,  4.400000e-01, -1.000000e+00, &
       9.000000e-01,  9.000000e-01,  9.000000e-01,  -1.000000e+00, -1.000000e+00, &
       1.000000e+00,  1.000000e+00,  4.000000e-01,  -1.000000e+00, 6.000000e-01, &
       3.000000e-01,  -1.000000e+00,  6.000000e-01,  1.000000e+00, 1.000000e+00, &
       -1.000000e+00,  -1.000000e+00,  -1.000000e+00, -1.000000e+00,  -1.000000e+00, &
       3.000000e-01,  2.000000e-01,  8.000000e-01,  5.000000e-01, 1.100000e+00, &
       -1.000000e+00,  7.000000e-01,  2.000000e+00,  1.000000e+00, -1.000000e+00, &
       1.000000e+00,  -1.000000e+00,  2.000000e+00,  1.000000e+00, 1.000000e+00, &
       -1.000000e+00,  1.000000e+00,  1.000000e+00,  2.000000e-01, 6.900000e-01, &
       3.000000e-02,  -1.000000e+00,  7.000000e-01,  3.000000e-02, -1.000000e+00, &
       8.000000e-02,  7.600000e-01,  6.200000e-01,  -1.000000e+00, 1.000000e+00, &
       -1.000000e+00,  1.000000e+00,  -1.000000e+00,  1.000000e+00, 1.000000e+00, &
       1.000000e+00,  5.000000e-01,  4.500000e-01,  5.000000e-01, 9.000000e-01, &
       -1.000000e+00,  5.500000e-01,  8.000000e-01,  6.000000e-01, -1.000000e+00 /)

     DOUBLE PRECISION, PARAMETER, DIMENSION(29) :: STOICM_2 = (/ &
       1.300000e-01,  4.000000e-01,  1.000000e+00,  1.000000e+00, 1.000000e+00, &
       -1.000000e+00,  2.000000e-01,  -1.000000e+00,  6.700000e-01, 2.000000e-01, &
       2.000000e-01,  6.000000e-02,  5.500000e-01,  1.000000e-01, 1.000000e+00, &
       -1.000000e+00,  4.000000e-01,  -1.000000e+00,  1.000000e-01, 4.400000e-01, &
       1.000000e+00,  -1.000000e+00,  -1.000000e+00,  -1.000000e+00, 1.000000e+00, &
       -1.000000e+00,  -2.000000e+00,  -1.000000e+00,  -1.000000e+00 /)

     DOUBLE PRECISION, PARAMETER, DIMENSION(329) :: STOICM = (/ STOICM_0, STOICM_1, STOICM_2 /)

CONTAINS
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ! 
    ! Update_SUN - update SUN light using TIME
    !   Arguments :
    ! 
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    SUBROUTINE Update_SUN(T)
    IMPLICIT NONE

    DOUBLE PRECISION :: T, SunRise, SunSet
    DOUBLE PRECISION :: Thour, Tlocal, Ttmp
    ! PI - Value of pi
    DOUBLE PRECISION, PARAMETER :: PI = 3.14159265358979d0
    SunRise = 4.5d0
    SunSet  = 19.5d0
    Thour = T/3600.0d0
    Tlocal = Thour - (INT(Thour)/24)*24

    IF ((Tlocal>=SunRise).AND.(Tlocal<=SunSet)) THEN
       Ttmp = (2.0*Tlocal - SunRise - SunSet) / (SunSet - SunRise)
       IF (Ttmp.GT.0) THEN
          Ttmp =  Ttmp*Ttmp
       ELSE
          Ttmp = -Ttmp*Ttmp
       END IF
       SUN = ( 1.0d0 + COS(PI*Ttmp) )/2.0d0
    ELSE
       SUN = 0.0d0
    END IF

    END SUBROUTINE Update_SUN
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ! 
    ! Update_RCONST - function to update rate constants
    !   Arguments :
    ! 
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    SUBROUTINE Update_RCONST ( )
    RCONST(1) = (8.89D-3*SUN)
    RCONST(2) = (ARR2(1.4D+3,1175.0D0))
    RCONST(3) = (ARR2(1.8D-12,-1370.0D0))
    ! RCONST(4) = constant rate coefficient
    RCONST(5) = (ARR2(1.6D-13,687.0D0))
    RCONST(6) = (ARR2(2.2D-13,602.0D0))
    RCONST(7) = (ARR2(1.2D-13,-2450.0D0))
    RCONST(8) = (3.556D-04*SUN)
    RCONST(9) = (2.489D-05*SUN)
    RCONST(10) = (ARR2(1.9D+8,390.0D0))
    ! RCONST(11) = constant rate coefficient
    RCONST(12) = (ARR2(1.6D-12,-940.0D0))
    RCONST(13) = (ARR2(1.4D-14,-580.0D0))
    RCONST(14) = (1.378D-01*SUN)
    RCONST(15) = (ARR2(1.3D-11,250.0D0))
    RCONST(16) = (ARR2(2.5D-14,-1230.0D0))
    RCONST(17) = (ARR2(5.3D-13,256.0D0))
    ! RCONST(18) = constant rate coefficient
    RCONST(19) = (ARR2(3.5D+14,-10897.0D0))
    RCONST(20) = (ARR2(1.8D-20,530.0D0))
    ! RCONST(21) = constant rate coefficient
    RCONST(22) = (ARR2(4.5D-13,806.0D0))
    RCONST(23) = (1.511D-03*SUN)
    ! RCONST(24) = constant rate coefficient
    ! RCONST(25) = constant rate coefficient
    RCONST(26) = (ARR2(1.0D-12,713.0D0))
    RCONST(27) = (ARR2(5.1D-15,1000.0D0))
    RCONST(28) = (ARR2(3.7D-12,240.0D0))
    RCONST(29) = (ARR2(1.2D-13,749.0D0))
    RCONST(30) = (ARR2(4.8D+13,-10121.0D0))
    RCONST(31) = (ARR2(1.3D-12,380.0D0))
    RCONST(32) = (ARR2(5.9D-14,1150.0D0))
    RCONST(33) = (ARR2(2.2D-38,5800.0D0))
    RCONST(34) = (6.312D-06*SUN)
    RCONST(35) = (ARR2(3.1D-12,-187.0D0))
    ! RCONST(36) = constant rate coefficient
    ! RCONST(37) = constant rate coefficient
    RCONST(38) = (2.845D-05*SUN)
    RCONST(39) = (3.734D-05*SUN)
    RCONST(40) = (ARR2(3.0D-11,-1550.0D0))
    ! RCONST(41) = constant rate coefficient
    RCONST(42) = (ARR2(1.2D-11,-986.0D0))
    RCONST(43) = (ARR2(7.0D-12,250.0D0))
    ! RCONST(44) = constant rate coefficient
    RCONST(45) = (4.00D-06*SUN)
    RCONST(46) = (ARR2(5.4D-12,250.0D0))
    RCONST(47) = (ARR2(8.0D-20,5500.0D0))
    RCONST(48) = (ARR2(9.4D+16,-14000.0D0))
    ! RCONST(49) = constant rate coefficient
    ! RCONST(50) = constant rate coefficient
    RCONST(51) = (ARR2(1.1D+2,-1710.0D0))
    ! RCONST(52) = constant rate coefficient
    RCONST(53) = (ARR2(1.0D+15,-8000.0D0))
    ! RCONST(54) = constant rate coefficient
    ! RCONST(55) = constant rate coefficient
    RCONST(56) = (ARR2(1.2D-11,-324.0D0))
    RCONST(57) = (ARR2(5.2D-12,504.0D0))
    RCONST(58) = (ARR2(1.4D-14,-2105.0D0))
    ! RCONST(59) = constant rate coefficient
    RCONST(60) = (ARR2(1.0D-11,-792.0D0))
    RCONST(61) = (ARR2(2.0D-12,411.0D0))
    RCONST(62) = (ARR2(1.3D-14,-2633.0D0))
    RCONST(63) = (ARR2(2.1D-12,322.0D0))
    ! RCONST(64) = constant rate coefficient
    ! RCONST(65) = constant rate coefficient
    ! RCONST(66) = constant rate coefficient
    ! RCONST(67) = constant rate coefficient
    ! RCONST(68) = constant rate coefficient
    RCONST(69) = (ARR2(1.7D-11,116.0D0))
    ! RCONST(70) = constant rate coefficient
    RCONST(71) = (5.334D-05*SUN)
    RCONST(72) = (ARR2(5.4D-17,-500.0D0))
    ! RCONST(73) = constant rate coefficient
    RCONST(74) = (1.654D-04*SUN)
    ! RCONST(75) = constant rate coefficient
    ! RCONST(76) = constant rate coefficient
    ! RCONST(77) = constant rate coefficient
    ! RCONST(78) = constant rate coefficient
    ! RCONST(79) = constant rate coefficient
    RCONST(80) = (ARR2(1.7D-14,1300.0D0))
    ! RCONST(81) = constant rate coefficient

    END SUBROUTINE Update_RCONST


    SUBROUTINE CBM4_FQ(V,F,RCT,Q)
    DOUBLE PRECISION :: V(NVAR),F(NFIX),RCT(NREACT),Q
    DOUBLE PRECISION :: A(3)
    Q = RCT(9)*V(25)-RCT(10)*V(1)-2.2D-10*V(1)*F(1)  ! f(1)
    END SUBROUTINE CBM4_FQ


    SUBROUTINE CBM4_FUN(V,F,RCT,Vdot)
    DOUBLE PRECISION :: V(NVAR),F(NFIX),RCT(NREACT),VDOT(NVAR)
    ! local variables
    DOUBLE PRECISION :: A(NREACT)
    ! Computation of equation rates
    A(1) = RCT(1)*V(26)
    A(2) = RCT(2)*V(29)
    A(3) = RCT(3)*V(25)*V(31)
    A(4) = 9.3D-12*V(26)*V(29)
    A(5) = RCT(5)*V(26)*V(29)
    A(6) = RCT(6)*V(29)*V(31)
    A(7) = RCT(7)*V(25)*V(26)
    A(8) = RCT(8)*V(25)
    A(9) = RCT(9)*V(25)
    A(10) = RCT(10)*V(1)
    A(11) = 2.2D-10*V(1)*F(1)
    A(12) = RCT(12)*V(25)*V(27)
    A(13) = RCT(13)*V(25)*V(28)
    A(14) = RCT(14)*V(30)
    A(15) = RCT(15)*V(30)*V(31)
    A(16) = RCT(16)*V(26)*V(30)
    A(17) = RCT(17)*V(26)*V(30)
    A(18) = 1.3D-21*V(6)*F(1)
    A(19) = RCT(19)*V(6)
    A(20) = RCT(20)*V(31)*V(31)
    A(21) = 4.39999D-40*V(26)*V(31)*F(1)
    A(22) = RCT(22)*V(27)*V(31)
    A(23) = RCT(23)*V(9)
    A(24) = 6.6D-12*V(9)*V(27)
    A(25) = 1D-20*V(9)*V(9)
    A(26) = RCT(26)*V(26)*V(27)
    A(27) = RCT(27)*V(12)*V(27)
    A(28) = RCT(28)*V(28)*V(31)
    A(29) = RCT(29)*V(26)*V(28)
    A(30) = RCT(30)*V(10)
    A(31) = RCT(31)*V(10)*V(27)
    A(32) = RCT(32)*V(28)*V(28)
    A(33) = RCT(33)*V(28)*V(28)*F(1)
    A(34) = RCT(34)*V(2)
    A(35) = RCT(35)*V(2)*V(27)
    A(36) = 2.2D-13*V(16)*V(27)
    A(37) = 1D-11*V(21)*V(27)
    A(38) = RCT(38)*V(21)
    A(39) = RCT(39)*V(21)
    A(40) = RCT(40)*V(21)*V(29)
    A(41) = 6.3D-16*V(21)*V(30)
    A(42) = RCT(42)*V(24)*V(29)
    A(43) = RCT(43)*V(24)*V(27)
    A(44) = 2.5D-15*V(24)*V(30)
    A(45) = RCT(45)*V(24)
    A(46) = RCT(46)*V(31)*V(32)
    A(47) = RCT(47)*V(26)*V(32)
    A(48) = RCT(48)*V(3)
    A(49) = 2D-12*V(32)*V(32)
    A(50) = 6.5D-12*V(28)*V(32)
    A(51) = RCT(51)*V(27)
    A(52) = 8.1D-13*V(20)*V(27)
    A(53) = RCT(53)*V(13)
    A(54) = 1600*V(13)
    A(55) = 1.5D-11*V(13)*V(26)
    A(56) = RCT(56)*V(23)*V(29)
    A(57) = RCT(57)*V(23)*V(27)
    A(58) = RCT(58)*V(23)*V(25)
    A(59) = 7.7D-15*V(23)*V(30)
    A(60) = RCT(60)*V(17)*V(29)
    A(61) = RCT(61)*V(17)*V(27)
    A(62) = RCT(62)*V(17)*V(25)
    A(63) = RCT(63)*V(5)*V(27)
    A(64) = 8.1D-12*V(11)*V(31)
    A(65) = 4.2*V(11)
    A(66) = 4.1D-11*V(14)*V(27)
    A(67) = 2.2D-11*V(14)*V(30)
    A(68) = 1.4D-11*V(4)*V(26)
    A(69) = RCT(69)*V(7)*V(27)
    A(70) = 3D-11*V(19)*V(27)
    A(71) = RCT(71)*V(19)
    A(72) = RCT(72)*V(19)*V(25)
    A(73) = 1.7D-11*V(15)*V(27)
    A(74) = RCT(74)*V(15)
    A(75) = 1.8D-11*V(22)*V(29)
    A(76) = 9.6D-11*V(22)*V(27)
    A(77) = 1.2D-17*V(22)*V(25)
    A(78) = 3.2D-13*V(22)*V(30)
    A(79) = 8.1D-12*V(18)*V(31)
    A(80) = RCT(80)*V(18)*V(18)
    A(81) = 6.8D-13*V(8)*V(31)

    ! Aggregate function
    Vdot(1) = A(9)-A(10)-A(11)
    Vdot(2) = A(32)+A(33)-A(34)-A(35)
    Vdot(3) = A(47)-A(48)
    Vdot(4) = 0.4*A(66)+A(67)-A(68)
    Vdot(5) = -A(63)
    Vdot(6) = A(17)-A(18)-A(19)
    Vdot(7) = -A(69)
    Vdot(8) = 0.13*A(52)+0.04*A(53)+0.02*A(56)+0.09*A(59)+0.13*A(76)+A(78)-A(81)
    Vdot(9) = 2*A(21)+A(22)-A(23)-A(24)-2*A(25)
    Vdot(10) = A(29)-A(30)-A(31)
    Vdot(11) = 0.56*A(63)-A(64)-A(65)+0.3*A(69)
    Vdot(12) = 2*A(18)+A(26)-A(27)+A(41)+A(44)+A(67)
    Vdot(13) = 0.76*A(52)-0.98*A(53)-A(54)-A(55)
    Vdot(14) = 0.36*A(63)+A(65)-A(66)-A(67)+0.2*A(69)
    Vdot(15) = 0.8*A(69)+0.2*A(72)-A(73)-A(74)+0.4*A(76)+0.2*A(77)
    Vdot(16) = -A(36)+A(37)+A(38)+A(39)+A(40)+A(41)+A(45)+0.3*A(56)+0.33*A(58)+A(60)+0.42*A(62)+2*A(70)+A(71)+0.69*A(72)&
               &+A(74)+0.5*A(75)+0.06*A(77)
    Vdot(17) = -A(60)-A(61)-A(62)+0.45*A(75)+A(76)+0.55*A(77)
    Vdot(18) = A(45)+A(46)+2*A(49)+0.79*A(50)+A(51)+0.87*A(52)+0.96*A(53)+0.28*A(56)+A(57)+0.22*A(58)+0.91*A(59)+0.7*A(60)&
               &+A(61)+0.08*A(63)+0.6*A(66)+0.5*A(69)+A(70)+0.03*A(72)+A(73)+0.5*A(75)+A(76)-A(79)-2*A(80)
    Vdot(19) = 0.9*A(64)+0.3*A(66)-A(70)-A(71)-A(72)
    Vdot(20) = -1.11*A(52)-2.1*A(53)+0.22*A(56)-A(57)-A(58)-A(59)+1.1*A(69)+0.9*A(75)+0.1*A(77)
    Vdot(21) = -A(37)-A(38)-A(39)-A(40)-A(41)+A(45)+A(46)+2*A(49)+0.79*A(50)+A(51)+0.2*A(56)+A(57)+0.74*A(58)+A(59)+A(60)&
               &+1.56*A(61)+A(62)+A(70)+0.7*A(72)+A(76)+A(77)
    Vdot(22) = -A(75)-A(76)-A(77)-A(78)
    Vdot(23) = -A(56)-A(57)-A(58)-A(59)+0.55*A(75)
    Vdot(24) = -A(42)-A(43)-A(44)-A(45)+0.11*A(52)+1.1*A(53)+0.63*A(56)+A(57)+0.5*A(58)+A(59)+0.22*A(61)+0.03*A(72)+0.8&
               &*A(75)+0.2*A(76)+0.4*A(77)
    Vdot(25) = A(2)-A(3)-A(7)-A(8)-A(9)-A(12)-A(13)-A(58)-A(62)-A(72)-A(77)
    Vdot(26) = -A(1)+A(3)-A(4)-A(5)+A(6)-A(7)+0.89*A(14)+2*A(15)-A(17)+A(19)+2*A(20)-A(21)+A(24)+A(25)-A(26)+A(28)-A(29)&
               &+A(30)+A(31)+A(46)-A(47)+A(48)-A(55)+A(59)+0.9*A(64)-A(68)+A(79)
    Vdot(27) = 2*A(11)-A(12)+A(13)-A(22)+A(23)-A(24)-A(26)-A(27)+A(28)-A(31)+2*A(34)-A(35)-A(36)-A(37)+A(40)+A(42)-A(43)&
               &+0.79*A(50)-A(51)-A(52)+0.2*A(56)-A(57)+0.1*A(58)+0.3*A(60)-A(61)-A(63)-A(66)-A(69)-A(70)+0.08*A(72)-A(73)&
               &-A(76)+0.1*A(77)
    Vdot(28) = A(12)-A(13)-A(28)-A(29)+A(30)-2*A(32)-2*A(33)+A(35)+A(36)+A(37)+2*A(38)+A(40)+A(41)+2*A(45)+A(46)+2*A(49)&
               &-0.21*A(50)+A(51)+0.11*A(52)+0.94*A(53)+A(54)+0.38*A(56)+A(57)+0.44*A(58)+1.7*A(60)+A(61)+0.12*A(62)+0.44&
               &*A(63)+0.9*A(64)+A(65)+0.6*A(66)+0.7*A(69)+2*A(70)+A(71)+0.76*A(72)+A(74)+0.6*A(75)+0.67*A(76)+0.44*A(77)
    Vdot(29) = A(1)-A(2)-A(4)-A(5)-A(6)+A(8)+A(10)+0.89*A(14)-A(40)-A(42)-A(56)-A(60)-A(75)
    Vdot(30) = A(5)+A(7)-A(14)-A(15)-A(16)-A(17)+A(19)+A(27)-A(41)-A(44)-A(59)-A(67)-A(78)
    Vdot(31) = A(1)-A(3)+A(4)-A(6)+0.11*A(14)-A(15)+A(16)-2*A(20)-A(21)-A(22)+A(23)+A(25)-A(28)-A(46)-A(64)-A(79)-A(81)
    Vdot(32) = A(42)+A(43)+A(44)-A(46)-A(47)+A(48)-2*A(49)-A(50)+A(70)+A(71)+0.62*A(72)+A(73)+A(74)+0.2*A(76)
    END SUBROUTINE CBM4_FUN

    SUBROUTINE CBM4_JAC ( V, F, RCT, JV )

    ! V - Concentrations of variable species (local)
    DOUBLE PRECISION :: V(NVAR)
    ! F - Concentrations of fixed species (local)
    DOUBLE PRECISION :: F(NFIX)
    ! RCT - Rate constants (local)
    DOUBLE PRECISION :: RCT(NREACT)
    ! JV - full Jacobian of variables
    DOUBLE PRECISION :: JV(NVAR,NVAR)


    ! Local variables
    ! B - Temporary array
    DOUBLE PRECISION :: B(138)

    ! B(1) = dA(1)/dV(26)
    B(1) = RCT(1)
    ! B(2) = dA(2)/dV(29)
    B(2) = RCT(2)
    ! B(3) = dA(3)/dV(25)
    B(3) = RCT(3)*V(31)
    ! B(4) = dA(3)/dV(31)
    B(4) = RCT(3)*V(25)
    ! B(5) = dA(4)/dV(26)
    B(5) = 9.3D-12*V(29)
    ! B(6) = dA(4)/dV(29)
    B(6) = 9.3D-12*V(26)
    ! B(7) = dA(5)/dV(26)
    B(7) = RCT(5)*V(29)
    ! B(8) = dA(5)/dV(29)
    B(8) = RCT(5)*V(26)
    ! B(9) = dA(6)/dV(29)
    B(9) = RCT(6)*V(31)
    ! B(10) = dA(6)/dV(31)
    B(10) = RCT(6)*V(29)
    ! B(11) = dA(7)/dV(25)
    B(11) = RCT(7)*V(26)
    ! B(12) = dA(7)/dV(26)
    B(12) = RCT(7)*V(25)
    ! B(13) = dA(8)/dV(25)
    B(13) = RCT(8)
    ! B(14) = dA(9)/dV(25)
    B(14) = RCT(9)
    ! B(15) = dA(10)/dV(1)
    B(15) = RCT(10)
    ! B(16) = dA(11)/dV(1)
    B(16) = 2.2D-10*F(1)
    ! B(18) = dA(12)/dV(25)
    B(18) = RCT(12)*V(27)
    ! B(19) = dA(12)/dV(27)
    B(19) = RCT(12)*V(25)
    ! B(20) = dA(13)/dV(25)
    B(20) = RCT(13)*V(28)
    ! B(21) = dA(13)/dV(28)
    B(21) = RCT(13)*V(25)
    ! B(22) = dA(14)/dV(30)
    B(22) = RCT(14)
    ! B(23) = dA(15)/dV(30)
    B(23) = RCT(15)*V(31)
    ! B(24) = dA(15)/dV(31)
    B(24) = RCT(15)*V(30)
    ! B(25) = dA(16)/dV(26)
    B(25) = RCT(16)*V(30)
    ! B(26) = dA(16)/dV(30)
    B(26) = RCT(16)*V(26)
    ! B(27) = dA(17)/dV(26)
    B(27) = RCT(17)*V(30)
    ! B(28) = dA(17)/dV(30)
    B(28) = RCT(17)*V(26)
    ! B(29) = dA(18)/dV(6)
    B(29) = 1.3D-21*F(1)
    ! B(31) = dA(19)/dV(6)
    B(31) = RCT(19)
    ! B(32) = dA(20)/dV(31)
    B(32) = RCT(20)*2*V(31)
    ! B(33) = dA(21)/dV(26)
    B(33) = 4.39999D-40*V(31)*F(1)
    ! B(34) = dA(21)/dV(31)
    B(34) = 4.39999D-40*V(26)*F(1)
    ! B(36) = dA(22)/dV(27)
    B(36) = RCT(22)*V(31)
    ! B(37) = dA(22)/dV(31)
    B(37) = RCT(22)*V(27)
    ! B(38) = dA(23)/dV(9)
    B(38) = RCT(23)
    ! B(39) = dA(24)/dV(9)
    B(39) = 6.6D-12*V(27)
    ! B(40) = dA(24)/dV(27)
    B(40) = 6.6D-12*V(9)
    ! B(41) = dA(25)/dV(9)
    B(41) = 1D-20*2*V(9)
    ! B(42) = dA(26)/dV(26)
    B(42) = RCT(26)*V(27)
    ! B(43) = dA(26)/dV(27)
    B(43) = RCT(26)*V(26)
    ! B(44) = dA(27)/dV(12)
    B(44) = RCT(27)*V(27)
    ! B(45) = dA(27)/dV(27)
    B(45) = RCT(27)*V(12)
    ! B(46) = dA(28)/dV(28)
    B(46) = RCT(28)*V(31)
    ! B(47) = dA(28)/dV(31)
    B(47) = RCT(28)*V(28)
    ! B(48) = dA(29)/dV(26)
    B(48) = RCT(29)*V(28)
    ! B(49) = dA(29)/dV(28)
    B(49) = RCT(29)*V(26)
    ! B(50) = dA(30)/dV(10)
    B(50) = RCT(30)
    ! B(51) = dA(31)/dV(10)
    B(51) = RCT(31)*V(27)
    ! B(52) = dA(31)/dV(27)
    B(52) = RCT(31)*V(10)
    ! B(53) = dA(32)/dV(28)
    B(53) = RCT(32)*2*V(28)
    ! B(54) = dA(33)/dV(28)
    B(54) = RCT(33)*2*V(28)*F(1)
    ! B(56) = dA(34)/dV(2)
    B(56) = RCT(34)
    ! B(57) = dA(35)/dV(2)
    B(57) = RCT(35)*V(27)
    ! B(58) = dA(35)/dV(27)
    B(58) = RCT(35)*V(2)
    ! B(59) = dA(36)/dV(16)
    B(59) = 2.2D-13*V(27)
    ! B(60) = dA(36)/dV(27)
    B(60) = 2.2D-13*V(16)
    ! B(61) = dA(37)/dV(21)
    B(61) = 1D-11*V(27)
    ! B(62) = dA(37)/dV(27)
    B(62) = 1D-11*V(21)
    ! B(63) = dA(38)/dV(21)
    B(63) = RCT(38)
    ! B(64) = dA(39)/dV(21)
    B(64) = RCT(39)
    ! B(65) = dA(40)/dV(21)
    B(65) = RCT(40)*V(29)
    ! B(66) = dA(40)/dV(29)
    B(66) = RCT(40)*V(21)
    ! B(67) = dA(41)/dV(21)
    B(67) = 6.3D-16*V(30)
    ! B(68) = dA(41)/dV(30)
    B(68) = 6.3D-16*V(21)
    ! B(69) = dA(42)/dV(24)
    B(69) = RCT(42)*V(29)
    ! B(70) = dA(42)/dV(29)
    B(70) = RCT(42)*V(24)
    ! B(71) = dA(43)/dV(24)
    B(71) = RCT(43)*V(27)
    ! B(72) = dA(43)/dV(27)
    B(72) = RCT(43)*V(24)
    ! B(73) = dA(44)/dV(24)
    B(73) = 2.5D-15*V(30)
    ! B(74) = dA(44)/dV(30)
    B(74) = 2.5D-15*V(24)
    ! B(75) = dA(45)/dV(24)
    B(75) = RCT(45)
    ! B(76) = dA(46)/dV(31)
    B(76) = RCT(46)*V(32)
    ! B(77) = dA(46)/dV(32)
    B(77) = RCT(46)*V(31)
    ! B(78) = dA(47)/dV(26)
    B(78) = RCT(47)*V(32)
    ! B(79) = dA(47)/dV(32)
    B(79) = RCT(47)*V(26)
    ! B(80) = dA(48)/dV(3)
    B(80) = RCT(48)
    ! B(81) = dA(49)/dV(32)
    B(81) = 2D-12*2*V(32)
    ! B(82) = dA(50)/dV(28)
    B(82) = 6.5D-12*V(32)
    ! B(83) = dA(50)/dV(32)
    B(83) = 6.5D-12*V(28)
    ! B(84) = dA(51)/dV(27)
    B(84) = RCT(51)
    ! B(85) = dA(52)/dV(20)
    B(85) = 8.1D-13*V(27)
    ! B(86) = dA(52)/dV(27)
    B(86) = 8.1D-13*V(20)
    ! B(87) = dA(53)/dV(13)
    B(87) = RCT(53)
    ! B(88) = dA(54)/dV(13)
    B(88) = 1600
    ! B(89) = dA(55)/dV(13)
    B(89) = 1.5D-11*V(26)
    ! B(90) = dA(55)/dV(26)
    B(90) = 1.5D-11*V(13)
    ! B(91) = dA(56)/dV(23)
    B(91) = RCT(56)*V(29)
    ! B(92) = dA(56)/dV(29)
    B(92) = RCT(56)*V(23)
    ! B(93) = dA(57)/dV(23)
    B(93) = RCT(57)*V(27)
    ! B(94) = dA(57)/dV(27)
    B(94) = RCT(57)*V(23)
    ! B(95) = dA(58)/dV(23)
    B(95) = RCT(58)*V(25)
    ! B(96) = dA(58)/dV(25)
    B(96) = RCT(58)*V(23)
    ! B(97) = dA(59)/dV(23)
    B(97) = 7.7D-15*V(30)
    ! B(98) = dA(59)/dV(30)
    B(98) = 7.7D-15*V(23)
    ! B(99) = dA(60)/dV(17)
    B(99) = RCT(60)*V(29)
    ! B(100) = dA(60)/dV(29)
    B(100) = RCT(60)*V(17)
    ! B(101) = dA(61)/dV(17)
    B(101) = RCT(61)*V(27)
    ! B(102) = dA(61)/dV(27)
    B(102) = RCT(61)*V(17)
    ! B(103) = dA(62)/dV(17)
    B(103) = RCT(62)*V(25)
    ! B(104) = dA(62)/dV(25)
    B(104) = RCT(62)*V(17)
    ! B(105) = dA(63)/dV(5)
    B(105) = RCT(63)*V(27)
    ! B(106) = dA(63)/dV(27)
    B(106) = RCT(63)*V(5)
    ! B(107) = dA(64)/dV(11)
    B(107) = 8.1D-12*V(31)
    ! B(108) = dA(64)/dV(31)
    B(108) = 8.1D-12*V(11)
    ! B(109) = dA(65)/dV(11)
    B(109) = 4.2
    ! B(110) = dA(66)/dV(14)
    B(110) = 4.1D-11*V(27)
    ! B(111) = dA(66)/dV(27)
    B(111) = 4.1D-11*V(14)
    ! B(112) = dA(67)/dV(14)
    B(112) = 2.2D-11*V(30)
    ! B(113) = dA(67)/dV(30)
    B(113) = 2.2D-11*V(14)
    ! B(114) = dA(68)/dV(4)
    B(114) = 1.4D-11*V(26)
    ! B(115) = dA(68)/dV(26)
    B(115) = 1.4D-11*V(4)
    ! B(116) = dA(69)/dV(7)
    B(116) = RCT(69)*V(27)
    ! B(117) = dA(69)/dV(27)
    B(117) = RCT(69)*V(7)
    ! B(118) = dA(70)/dV(19)
    B(118) = 3D-11*V(27)
    ! B(119) = dA(70)/dV(27)
    B(119) = 3D-11*V(19)
    ! B(120) = dA(71)/dV(19)
    B(120) = RCT(71)
    ! B(121) = dA(72)/dV(19)
    B(121) = RCT(72)*V(25)
    ! B(122) = dA(72)/dV(25)
    B(122) = RCT(72)*V(19)
    ! B(123) = dA(73)/dV(15)
    B(123) = 1.7D-11*V(27)
    ! B(124) = dA(73)/dV(27)
    B(124) = 1.7D-11*V(15)
    ! B(125) = dA(74)/dV(15)
    B(125) = RCT(74)
    ! B(126) = dA(75)/dV(22)
    B(126) = 1.8D-11*V(29)
    ! B(127) = dA(75)/dV(29)
    B(127) = 1.8D-11*V(22)
    ! B(128) = dA(76)/dV(22)
    B(128) = 9.6D-11*V(27)
    ! B(129) = dA(76)/dV(27)
    B(129) = 9.6D-11*V(22)
    ! B(130) = dA(77)/dV(22)
    B(130) = 1.2D-17*V(25)
    ! B(131) = dA(77)/dV(25)
    B(131) = 1.2D-17*V(22)
    ! B(132) = dA(78)/dV(22)
    B(132) = 3.2D-13*V(30)
    ! B(133) = dA(78)/dV(30)
    B(133) = 3.2D-13*V(22)
    ! B(134) = dA(79)/dV(18)
    B(134) = 8.1D-12*V(31)
    ! B(135) = dA(79)/dV(31)
    B(135) = 8.1D-12*V(18)
    ! B(136) = dA(80)/dV(18)
    B(136) = RCT(80)*2*V(18)
    ! B(137) = dA(81)/dV(8)
    B(137) = 6.8D-13*V(31)
    ! B(138) = dA(81)/dV(31)
    B(138) = 6.8D-13*V(8)

    ! Construct the Jacobian terms from B's
    JV(1,1)   = -B(15)-B(16)
    JV(1,25)  = B(14)
    JV(2,2)   = -B(56)-B(57)
    JV(2,27)  = -B(58)
    JV(2,28)  = B(53)+B(54)
    JV(3,3)   = -B(80)
    JV(3,26)  = B(78)
    JV(3,32)  = B(79)
    JV(4,4)   = -B(114)
    JV(4,14)  = 0.4*B(110)+B(112)
    JV(4,26)  = -B(115)
    JV(4,27)  = 0.4*B(111)
    JV(4,30)  = B(113)
    JV(5,5)   = -B(105)
    JV(5,27)  = -B(106)
    JV(6,6)   = -B(29)-B(31)
    JV(6,26)  = B(27)
    JV(6,30)  = B(28)
    JV(7,7)   = -B(116)
    JV(7,27)  = -B(117)
    JV(8,8)   = -B(137)
    JV(8,13)  = 0.04*B(87)
    JV(8,20)  = 0.13*B(85)
    JV(8,22)  = 0.13*B(128)+B(132)
    JV(8,23)  = 0.02*B(91)+0.09*B(97)
    JV(8,27)  = 0.13*B(86)+0.13*B(129)
    JV(8,29)  = 0.02*B(92)
    JV(8,30)  = 0.09*B(98)+B(133)
    JV(8,31)  = -B(138)
    JV(9,9)   = -B(38)-B(39)-2*B(41)
    JV(9,26)  = 2*B(33)
    JV(9,27)  = B(36)-B(40)
    JV(9,31)  = 2*B(34)+B(37)
    JV(10,10) = -B(50)-B(51)
    JV(10,26) = B(48)
    JV(10,27) = -B(52)
    JV(10,28) = B(49)
    JV(11,5)  = 0.56*B(105)
    JV(11,7)  = 0.3*B(116)
    JV(11,11) = -B(107)-B(109)
    JV(11,27) = 0.56*B(106)+0.3*B(117)
    JV(11,31) = -B(108)
    JV(12,6)  = 2*B(29)
    JV(12,12) = -B(44)
    JV(12,14) = B(112)
    JV(12,21) = B(67)
    JV(12,24) = B(73)
    JV(12,26) = B(42)
    JV(12,27) = B(43)-B(45)
    JV(12,30) = B(68)+B(74)+B(113)
    JV(13,13) = -0.98*B(87)-B(88)-B(89)
    JV(13,20) = 0.76*B(85)
    JV(13,26) = -B(90)
    JV(13,27) = 0.76*B(86)
    JV(14,5)  = 0.36*B(105)
    JV(14,7)  = 0.2*B(116)
    JV(14,11) = B(109)
    JV(14,14) = -B(110)-B(112)
    JV(14,27) = 0.36*B(106)-B(111)+0.2*B(117)
    JV(14,30) = -B(113)
    JV(15,7)  = 0.8*B(116)
    JV(15,15) = -B(123)-B(125)
    JV(15,19) = 0.2*B(121)
    JV(15,22) = 0.4*B(128)+0.2*B(130)
    JV(15,25) = 0.2*B(122)+0.2*B(131)
    JV(15,27) = 0.8*B(117)-B(124)+0.4*B(129)
    JV(16,15) = B(125)
    JV(16,16) = -B(59)
    JV(16,17) = B(99)+0.42*B(103)
    JV(16,19) = 2*B(118)+B(120)+0.69*B(121)
    JV(16,21) = B(61)+B(63)+B(64)+B(65)+B(67)
    JV(16,22) = 0.5*B(126)+0.06*B(130)
    JV(16,23) = 0.3*B(91)+0.33*B(95)
    JV(16,24) = B(75)
    JV(16,25) = 0.33*B(96)+0.42*B(104)+0.69*B(122)+0.06*B(131)
    JV(16,27) = -B(60)+B(62)+2*B(119)
    JV(16,29) = B(66)+0.3*B(92)+B(100)+0.5*B(127)
    JV(16,30) = B(68)
    JV(17,17) = -B(99)-B(101)-B(103)
    JV(17,22) = 0.45*B(126)+B(128)+0.55*B(130)
    JV(17,25) = -B(104)+0.55*B(131)
    JV(17,27) = -B(102)+B(129)
    JV(17,29) = -B(100)+0.45*B(127)
    JV(18,5)  = 0.08*B(105)
    JV(18,7)  = 0.5*B(116)
    JV(18,13) = 0.96*B(87)
    JV(18,14) = 0.6*B(110)
    JV(18,15) = B(123)
    JV(18,17) = 0.7*B(99)+B(101)
    JV(18,18) = -B(134)-2*B(136)
    JV(18,19) = B(118)+0.03*B(121)
    JV(18,20) = 0.87*B(85)
    JV(18,22) = 0.5*B(126)+B(128)
    JV(18,23) = 0.28*B(91)+B(93)+0.22*B(95)+0.91*B(97)
    JV(18,24) = B(75)
    JV(18,25) = 0.22*B(96)+0.03*B(122)
    JV(18,27) = B(84)+0.87*B(86)+B(94)+B(102)+0.08*B(106)+0.6*B(111)+0.5*B(117)+B(119)+B(124)+B(129)
    JV(18,28) = 0.79*B(82)
    JV(18,29) = 0.28*B(92)+0.7*B(100)+0.5*B(127)
    JV(18,30) = 0.91*B(98)
    JV(18,31) = B(76)-B(135)
    JV(18,32) = B(77)+2*B(81)+0.79*B(83)
    JV(19,11) = 0.9*B(107)
    JV(19,14) = 0.3*B(110)
    JV(19,19) = -B(118)-B(120)-B(121)
    JV(19,25) = -B(122)
    JV(19,27) = 0.3*B(111)-B(119)
    JV(19,31) = 0.9*B(108)
    JV(20,7)  = 1.1*B(116)
    JV(20,13) = -2.1*B(87)
    JV(20,20) = -1.11*B(85)
    JV(20,22) = 0.9*B(126)+0.1*B(130)
    JV(20,23) = 0.22*B(91)-B(93)-B(95)-B(97)
    JV(20,25) = -B(96)+0.1*B(131)
    JV(20,27) = -1.11*B(86)-B(94)+1.1*B(117)
    JV(20,29) = 0.22*B(92)+0.9*B(127)
    JV(20,30) = -B(98)
    JV(21,17) = B(99)+1.56*B(101)+B(103)
    JV(21,19) = B(118)+0.7*B(121)
    JV(21,21) = -B(61)-B(63)-B(64)-B(65)-B(67)
    JV(21,22) = B(128)+B(130)
    JV(21,23) = 0.2*B(91)+B(93)+0.74*B(95)+B(97)
    JV(21,24) = B(75)
    JV(21,25) = 0.74*B(96)+B(104)+0.7*B(122)+B(131)
    JV(21,27) = -B(62)+B(84)+B(94)+1.56*B(102)+B(119)+B(129)
    JV(21,28) = 0.79*B(82)
    JV(21,29) = -B(66)+0.2*B(92)+B(100)
    JV(21,30) = -B(68)+B(98)
    JV(21,31) = B(76)
    JV(21,32) = B(77)+2*B(81)+0.79*B(83)
    JV(22,22) = -B(126)-B(128)-B(130)-B(132)
    JV(22,25) = -B(131)
    JV(22,27) = -B(129)
    JV(22,29) = -B(127)
    JV(22,30) = -B(133)
    JV(23,22) = 0.55*B(126)
    JV(23,23) = -B(91)-B(93)-B(95)-B(97)
    JV(23,25) = -B(96)
    JV(23,27) = -B(94)
    JV(23,29) = -B(92)+0.55*B(127)
    JV(23,30) = -B(98)
    JV(24,13) = 1.1*B(87)
    JV(24,17) = 0.22*B(101)
    JV(24,19) = 0.03*B(121)
    JV(24,20) = 0.11*B(85)
    JV(24,22) = 0.8*B(126)+0.2*B(128)+0.4*B(130)
    JV(24,23) = 0.63*B(91)+B(93)+0.5*B(95)+B(97)
    JV(24,24) = -B(69)-B(71)-B(73)-B(75)
    JV(24,25) = 0.5*B(96)+0.03*B(122)+0.4*B(131)
    JV(24,27) = -B(72)+0.11*B(86)+B(94)+0.22*B(102)+0.2*B(129)
    JV(24,29) = -B(70)+0.63*B(92)+0.8*B(127)
    JV(24,30) = -B(74)+B(98)
    JV(25,17) = -B(103)
    JV(25,19) = -B(121)
    JV(25,22) = -B(130)
    JV(25,23) = -B(95)
    JV(25,25) = -B(3)-B(11)-B(13)-B(14)-B(18)-B(20)-B(96)-B(104)-B(122)-B(131)
    JV(25,26) = -B(12)
    JV(25,27) = -B(19)
    JV(25,28) = -B(21)
    JV(25,29) = B(2)
    JV(25,31) = -B(4)
    JV(26,3)  = B(80)
    JV(26,4)  = -B(114)
    JV(26,6)  = B(31)
    JV(26,9)  = B(39)+B(41)
    JV(26,10) = B(50)+B(51)
    JV(26,11) = 0.9*B(107)
    JV(26,13) = -B(89)
    JV(26,18) = B(134)
    JV(26,23) = B(97)
    JV(26,25) = B(3)-B(11)
    JV(26,26) = -B(1)-B(5)-B(7)-B(12)-B(27)-B(33)-B(42)-B(48)-B(78)-B(90)-B(115)
    JV(26,27) = B(40)-B(43)+B(52)
    JV(26,28) = B(46)-B(49)
    JV(26,29) = -B(6)-B(8)+B(9)
    JV(26,30) = 0.89*B(22)+2*B(23)-B(28)+B(98)
    JV(26,31) = B(4)+B(10)+2*B(24)+2*B(32)-B(34)+B(47)+B(76)+0.9*B(108)+B(135)
    JV(26,32) = B(77)-B(79)
    JV(27,1)  = 2*B(16)
    JV(27,2)  = 2*B(56)-B(57)
    JV(27,5)  = -B(105)
    JV(27,7)  = -B(116)
    JV(27,9)  = B(38)-B(39)
    JV(27,10) = -B(51)
    JV(27,12) = -B(44)
    JV(27,14) = -B(110)
    JV(27,15) = -B(123)
    JV(27,16) = -B(59)
    JV(27,17) = 0.3*B(99)-B(101)
    JV(27,19) = -B(118)+0.08*B(121)
    JV(27,20) = -B(85)
    JV(27,21) = -B(61)+B(65)
    JV(27,22) = -B(128)+0.1*B(130)
    JV(27,23) = 0.2*B(91)-B(93)+0.1*B(95)
    JV(27,24) = B(69)-B(71)
    JV(27,25) = -B(18)+B(20)+0.1*B(96)+0.08*B(122)+0.1*B(131)
    JV(27,26) = -B(42)
    JV(27,27) = -B(19)-B(36)-B(40)-B(43)-B(45)-B(52)-B(58)-B(60)-B(62)-B(72)-B(84)-B(86)-B(94)-B(102)-B(106)-B(111)-B(117)&
                &-B(119)-B(124)-B(129)
    JV(27,28) = B(21)+B(46)+0.79*B(82)
    JV(27,29) = B(66)+B(70)+0.2*B(92)+0.3*B(100)
    JV(27,31) = -B(37)+B(47)
    JV(27,32) = 0.79*B(83)
    JV(28,2)  = B(57)
    JV(28,5)  = 0.44*B(105)
    JV(28,7)  = 0.7*B(116)
    JV(28,10) = B(50)
    JV(28,11) = 0.9*B(107)+B(109)
    JV(28,13) = 0.94*B(87)+B(88)
    JV(28,14) = 0.6*B(110)
    JV(28,15) = B(125)
    JV(28,16) = B(59)
    JV(28,17) = 1.7*B(99)+B(101)+0.12*B(103)
    JV(28,19) = 2*B(118)+B(120)+0.76*B(121)
    JV(28,20) = 0.11*B(85)
    JV(28,21) = B(61)+2*B(63)+B(65)+B(67)
    JV(28,22) = 0.6*B(126)+0.67*B(128)+0.44*B(130)
    JV(28,23) = 0.38*B(91)+B(93)+0.44*B(95)
    JV(28,24) = 2*B(75)
    JV(28,25) = B(18)-B(20)+0.44*B(96)+0.12*B(104)+0.76*B(122)+0.44*B(131)
    JV(28,26) = -B(48)
    JV(28,27) = B(19)+B(58)+B(60)+B(62)+B(84)+0.11*B(86)+B(94)+B(102)+0.44*B(106)+0.6*B(111)+0.7*B(117)+2*B(119)+0.67&
                &*B(129)
    JV(28,28) = -B(21)-B(46)-B(49)-2*B(53)-2*B(54)-0.21*B(82)
    JV(28,29) = B(66)+0.38*B(92)+1.7*B(100)+0.6*B(127)
    JV(28,30) = B(68)
    JV(28,31) = -B(47)+B(76)+0.9*B(108)
    JV(28,32) = B(77)+2*B(81)-0.21*B(83)
    JV(29,1)  = B(15)
    JV(29,17) = -B(99)
    JV(29,21) = -B(65)
    JV(29,22) = -B(126)
    JV(29,23) = -B(91)
    JV(29,24) = -B(69)
    JV(29,25) = B(13)
    JV(29,26) = B(1)-B(5)-B(7)
    JV(29,29) = -B(2)-B(6)-B(8)-B(9)-B(66)-B(70)-B(92)-B(100)-B(127)
    JV(29,30) = 0.89*B(22)
    JV(29,31) = -B(10)
    JV(30,6)  = B(31)
    JV(30,12) = B(44)
    JV(30,14) = -B(112)
    JV(30,21) = -B(67)
    JV(30,22) = -B(132)
    JV(30,23) = -B(97)
    JV(30,24) = -B(73)
    JV(30,25) = B(11)
    JV(30,26) = B(7)+B(12)-B(25)-B(27)
    JV(30,27) = B(45)
    JV(30,29) = B(8)
    JV(30,30) = -B(22)-B(23)-B(26)-B(28)-B(68)-B(74)-B(98)-B(113)-B(133)
    JV(30,31) = -B(24)
    JV(31,8)  = -B(137)
    JV(31,9)  = B(38)+B(41)
    JV(31,11) = -B(107)
    JV(31,18) = -B(134)
    JV(31,25) = -B(3)
    JV(31,26) = B(1)+B(5)+B(25)-B(33)
    JV(31,27) = -B(36)
    JV(31,28) = -B(46)
    JV(31,29) = B(6)-B(9)
    JV(31,30) = 0.11*B(22)-B(23)+B(26)
    JV(31,31) = -B(4)-B(10)-B(24)-2*B(32)-B(34)-B(37)-B(47)-B(76)-B(108)-B(135)-B(138)
    JV(31,32) = -B(77)
    JV(32,3)  = B(80)
    JV(32,15) = B(123)+B(125)
    JV(32,19) = B(118)+B(120)+0.62*B(121)
    JV(32,22) = 0.2*B(128)
    JV(32,24) = B(69)+B(71)+B(73)
    JV(32,25) = 0.62*B(122)
    JV(32,26) = -B(78)
    JV(32,27) = B(72)+B(119)+B(124)+0.2*B(129)
    JV(32,28) = -B(82)
    JV(32,29) = B(70)
    JV(32,30) = B(74)
    JV(32,31) = -B(76)
    JV(32,32) = -B(77)-B(79)-2*B(81)-B(83)
      
    END SUBROUTINE CBM4_JAC

    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ! 
    ! ReactantProd - Reactant Products in each equation
    !   Arguments :
    !      V         - Concentrations of variable species (local)
    !      F         - Concentrations of fixed species (local)
    !      ARP       - Reactant product in each equation
    ! 
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    SUBROUTINE ReactantProd ( V, F, ARP )

    ! V - Concentrations of variable species (local)
    DOUBLE PRECISION :: V(NVAR)
    ! F - Concentrations of fixed species (local)
    DOUBLE PRECISION :: F(NFIX)
    ! ARP - Reactant product in each equation
    DOUBLE PRECISION :: ARP(NREACT)

    ! Reactant Products in each equation are useful in the
    !     stoichiometric formulation of mass action law
    ARP(1) = V(26)
    ARP(2) = V(29)
    ARP(3) = V(25)*V(31)
    ARP(4) = V(26)*V(29)
    ARP(5) = V(26)*V(29)
    ARP(6) = V(29)*V(31)
    ARP(7) = V(25)*V(26)
    ARP(8) = V(25)
    ARP(9) = V(25)
    ARP(10) = V(1)
    ARP(11) = V(1)*F(1)
    ARP(12) = V(25)*V(27)
    ARP(13) = V(25)*V(28)
    ARP(14) = V(30)
    ARP(15) = V(30)*V(31)
    ARP(16) = V(26)*V(30)
    ARP(17) = V(26)*V(30)
    ARP(18) = V(6)*F(1)
    ARP(19) = V(6)
    ARP(20) = V(31)*V(31)
    ARP(21) = V(26)*V(31)*F(1)
    ARP(22) = V(27)*V(31)
    ARP(23) = V(9)
    ARP(24) = V(9)*V(27)
    ARP(25) = V(9)*V(9)
    ARP(26) = V(26)*V(27)
    ARP(27) = V(12)*V(27)
    ARP(28) = V(28)*V(31)
    ARP(29) = V(26)*V(28)
    ARP(30) = V(10)
    ARP(31) = V(10)*V(27)
    ARP(32) = V(28)*V(28)
    ARP(33) = V(28)*V(28)*F(1)
    ARP(34) = V(2)
    ARP(35) = V(2)*V(27)
    ARP(36) = V(16)*V(27)
    ARP(37) = V(21)*V(27)
    ARP(38) = V(21)
    ARP(39) = V(21)
    ARP(40) = V(21)*V(29)
    ARP(41) = V(21)*V(30)
    ARP(42) = V(24)*V(29)
    ARP(43) = V(24)*V(27)
    ARP(44) = V(24)*V(30)
    ARP(45) = V(24)
    ARP(46) = V(31)*V(32)
    ARP(47) = V(26)*V(32)
    ARP(48) = V(3)
    ARP(49) = V(32)*V(32)
    ARP(50) = V(28)*V(32)
    ARP(51) = V(27)
    ARP(52) = V(20)*V(27)
    ARP(53) = V(13)
    ARP(54) = V(13)
    ARP(55) = V(13)*V(26)
    ARP(56) = V(23)*V(29)
    ARP(57) = V(23)*V(27)
    ARP(58) = V(23)*V(25)
    ARP(59) = V(23)*V(30)
    ARP(60) = V(17)*V(29)
    ARP(61) = V(17)*V(27)
    ARP(62) = V(17)*V(25)
    ARP(63) = V(5)*V(27)
    ARP(64) = V(11)*V(31)
    ARP(65) = V(11)
    ARP(66) = V(14)*V(27)
    ARP(67) = V(14)*V(30)
    ARP(68) = V(4)*V(26)
    ARP(69) = V(7)*V(27)
    ARP(70) = V(19)*V(27)
    ARP(71) = V(19)
    ARP(72) = V(19)*V(25)
    ARP(73) = V(15)*V(27)
    ARP(74) = V(15)
    ARP(75) = V(22)*V(29)
    ARP(76) = V(22)*V(27)
    ARP(77) = V(22)*V(25)
    ARP(78) = V(22)*V(30)
    ARP(79) = V(18)*V(31)
    ARP(80) = V(18)*V(18)
    ARP(81) = V(8)*V(31)
      
    END SUBROUTINE ReactantProd

    ! End of ReactantProd function
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    ! Begin Derivative w.r.t. Rate Coefficients

    ! ------------------------------------------------------------------------------
    ! Subroutine for the derivative of Fun with respect to rate coefficients
    ! -----------------------------------------------------------------------------

    SUBROUTINE  dFun_dRcoeff( V, F, NCOEFF, JCOEFF, DFDR )
    IMPLICIT NONE 
    ! V - Concentrations of variable/radical/fixed species            
    DOUBLE PRECISION :: V(NVAR), F(NFIX)
    ! NCOEFF - the number of rate coefficients with respect to which we
    ! differentiate
    INTEGER :: NCOEFF       
    ! JCOEFF - a vector of integers containing the indices of reactions (rate
    !          coefficients) with respect to which we differentiate
    INTEGER :: JCOEFF(NCOEFF)       
    ! DFDR  - a matrix containg derivative values; specifically, 
    !         column j contains d Fun(1:NVAR) / d RCT( JCOEFF(j) )
    !         for each 1 <= j <= NCOEFF
    !         This matrix is stored in a column-wise linearized format
    DOUBLE PRECISION :: DFDR(NVAR,NCOEFF)

    ! Local vector with reactant products
    DOUBLE PRECISION :: A_RPROD(NREACT)
    DOUBLE PRECISION :: aj
    INTEGER :: i,j,k
      
    ! Compute the reactant products of all reactions     
    CALL ReactantProd ( V, F, A_RPROD )

    ! Compute the derivatives by multiplying column JCOEFF(j) of the stoichiometric
    ! matrix with A_RPROD       
      DO j=1,NCOEFF
         ! Initialize the j-th column of derivative matrix to zero       
         DO i=1,NVAR
           DFDR(i,j) = 0.0 
         END DO
         ! Column JCOEFF(j) in the stoichiometric matrix times the
         ! reactant product  of the JCOEFF(j)-th reaction      
         ! give the j-th column of the derivative matrix   
         aj = A_RPROD(JCOEFF(j))
         DO k=CCOL_STOICM(JCOEFF(j)),CCOL_STOICM(JCOEFF(j)+1)-1
           DFDR(IROW_STOICM(k),j) = STOICM(k)*aj
         END DO
      END DO
      
    END SUBROUTINE  dFun_dRcoeff



    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ! 
    ! Hessian - function for Hessian (Jac derivative w.r.t. variables)
    !   Arguments :
    !      V         - Concentrations of variable species (local)
    !      F         - Concentrations of fixed species (local)
    !      RCT       - Rate constants (local)
    !      HESS      - Hessian of Var (i.e. the 3-tensor d Jac / d Var)
    ! 
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    SUBROUTINE Hessian ( V, F, RCT, HESS )

    ! V - Concentrations of variable species (local)
    DOUBLE PRECISION :: V(NVAR)
    ! F - Concentrations of fixed species (local)
    DOUBLE PRECISION :: F(NFIX)
    ! RCT - Rate constants (local)
    DOUBLE PRECISION :: RCT(NREACT)
    ! HESS - Hessian of Var (i.e. the 3-tensor d Jac / d Var)
    DOUBLE PRECISION :: HESS(NHESS)

    ! --------------------------------------------------------
    ! Note: HESS is represented in coordinate sparse format:
    !       HESS(m) = d^2 f_i / dv_j dv_k = d Jac_{i,j} / dv_k
    !       where i = IHESS_I(m), j = IHESS_J(m), k = IHESS_K(m).
    ! --------------------------------------------------------
    ! Note: d^2 f_i / dv_j dv_k = d^2 f_i / dv_k dv_j,
    !       therefore only the terms d^2 f_i / dv_j dv_k
    !       with j <= k are computed and stored in HESS.
    ! --------------------------------------------------------

    ! Local variables
    ! D2A - Second derivatives of equation rates
  DOUBLE PRECISION :: D2A(59)

    ! Computation of the second derivatives of equation rates
    ! D2A(1) = d^2 A(3) / dV(25)dV(31)
    D2A(1) = RCT(3)
    ! D2A(2) = d^2 A(4) / dV(26)dV(29)
    D2A(2) = 9.3e-12
    ! D2A(3) = d^2 A(5) / dV(26)dV(29)
    D2A(3) = RCT(5)
    ! D2A(4) = d^2 A(6) / dV(29)dV(31)
    D2A(4) = RCT(6)
    ! D2A(5) = d^2 A(7) / dV(25)dV(26)
    D2A(5) = RCT(7)
    ! D2A(6) = d^2 A(12) / dV(25)dV(27)
    D2A(6) = RCT(12)
    ! D2A(7) = d^2 A(13) / dV(25)dV(28)
    D2A(7) = RCT(13)
    ! D2A(8) = d^2 A(15) / dV(30)dV(31)
    D2A(8) = RCT(15)
    ! D2A(9) = d^2 A(16) / dV(26)dV(30)
    D2A(9) = RCT(16)
    ! D2A(10) = d^2 A(17) / dV(26)dV(30)
    D2A(10) = RCT(17)
    ! D2A(11) = d^2 A(20)/{dV(31)dV(31)}
    D2A(11) = RCT(20)*2
    ! D2A(12) = d^2 A(21) / dV(26)dV(31)
    D2A(12) = 4.39999e-40*F(1)
    ! D2A(13) = d^2 A(22) / dV(27)dV(31)
    D2A(13) = RCT(22)
    ! D2A(14) = d^2 A(24) / dV(9)dV(27)
    D2A(14) = 6.6e-12
    ! D2A(15) = d^2 A(25)/{dV(9)dV(9)}
    D2A(15) = 1e-20*2
    ! D2A(16) = d^2 A(26) / dV(26)dV(27)
    D2A(16) = RCT(26)
    ! D2A(17) = d^2 A(27) / dV(12)dV(27)
    D2A(17) = RCT(27)
    ! D2A(18) = d^2 A(28) / dV(28)dV(31)
    D2A(18) = RCT(28)
    ! D2A(19) = d^2 A(29) / dV(26)dV(28)
    D2A(19) = RCT(29)
    ! D2A(20) = d^2 A(31) / dV(10)dV(27)
    D2A(20) = RCT(31)
    ! D2A(21) = d^2 A(32)/{dV(28)dV(28)}
    D2A(21) = RCT(32)*2
    ! D2A(22) = d^2 A(33)/{dV(28)dV(28)}
    D2A(22) = RCT(33)*2*F(1)
    ! D2A(23) = d^2 A(35) / dV(2)dV(27)
    D2A(23) = RCT(35)
    ! D2A(24) = d^2 A(36) / dV(16)dV(27)
    D2A(24) = 2.2e-13
    ! D2A(25) = d^2 A(37) / dV(21)dV(27)
    D2A(25) = 1e-11
    ! D2A(26) = d^2 A(40) / dV(21)dV(29)
    D2A(26) = RCT(40)
    ! D2A(27) = d^2 A(41) / dV(21)dV(30)
    D2A(27) = 6.3e-16
    ! D2A(28) = d^2 A(42) / dV(24)dV(29)
    D2A(28) = RCT(42)
    ! D2A(29) = d^2 A(43) / dV(24)dV(27)
    D2A(29) = RCT(43)
    ! D2A(30) = d^2 A(44) / dV(24)dV(30)
    D2A(30) = 2.5e-15
    ! D2A(31) = d^2 A(46) / dV(31)dV(32)
    D2A(31) = RCT(46)
    ! D2A(32) = d^2 A(47) / dV(26)dV(32)
    D2A(32) = RCT(47)
    ! D2A(33) = d^2 A(49)/{dV(32)dV(32)}
    D2A(33) = 2e-12*2
    ! D2A(34) = d^2 A(50) / dV(28)dV(32)
    D2A(34) = 6.5e-12
    ! D2A(35) = d^2 A(52) / dV(20)dV(27)
    D2A(35) = 8.1e-13
    ! D2A(36) = d^2 A(55) / dV(13)dV(26)
    D2A(36) = 1.5e-11
    ! D2A(37) = d^2 A(56) / dV(23)dV(29)
    D2A(37) = RCT(56)
    ! D2A(38) = d^2 A(57) / dV(23)dV(27)
    D2A(38) = RCT(57)
    ! D2A(39) = d^2 A(58) / dV(23)dV(25)
    D2A(39) = RCT(58)
    ! D2A(40) = d^2 A(59) / dV(23)dV(30)
    D2A(40) = 7.7e-15
    ! D2A(41) = d^2 A(60) / dV(17)dV(29)
    D2A(41) = RCT(60)
    ! D2A(42) = d^2 A(61) / dV(17)dV(27)
    D2A(42) = RCT(61)
    ! D2A(43) = d^2 A(62) / dV(17)dV(25)
    D2A(43) = RCT(62)
    ! D2A(44) = d^2 A(63) / dV(5)dV(27)
    D2A(44) = RCT(63)
    ! D2A(45) = d^2 A(64) / dV(11)dV(31)
    D2A(45) = 8.1e-12
    ! D2A(46) = d^2 A(66) / dV(14)dV(27)
    D2A(46) = 4.1e-11
    ! D2A(47) = d^2 A(67) / dV(14)dV(30)
    D2A(47) = 2.2e-11
    ! D2A(48) = d^2 A(68) / dV(4)dV(26)
    D2A(48) = 1.4e-11
    ! D2A(49) = d^2 A(69) / dV(7)dV(27)
    D2A(49) = RCT(69)
    ! D2A(50) = d^2 A(70) / dV(19)dV(27)
    D2A(50) = 3e-11
    ! D2A(51) = d^2 A(72) / dV(19)dV(25)
    D2A(51) = RCT(72)
    ! D2A(52) = d^2 A(73) / dV(15)dV(27)
    D2A(52) = 1.7e-11
    ! D2A(53) = d^2 A(75) / dV(22)dV(29)
    D2A(53) = 1.8e-11
    ! D2A(54) = d^2 A(76) / dV(22)dV(27)
    D2A(54) = 9.6e-11
    ! D2A(55) = d^2 A(77) / dV(22)dV(25)
    D2A(55) = 1.2e-17
    ! D2A(56) = d^2 A(78) / dV(22)dV(30)
    D2A(56) = 3.2e-13
    ! D2A(57) = d^2 A(79) / dV(18)dV(31)
    D2A(57) = 8.1e-12
    ! D2A(58) = d^2 A(80)/{dV(18)dV(18)}
    D2A(58) = RCT(80)*2
    ! D2A(59) = d^2 A(81) / dV(8)dV(31)
    D2A(59) = 6.8e-13

    ! Computation of the Jacobian derivative
    ! HESS(1) = d^2 Vdot(2)/{dV(2)dV(27)} = d^2 Vdot(2)/{dV(27)dV(2)}
    HESS(1) = -D2A(23)
    ! HESS(2) = d^2 Vdot(2)/{dV(28)dV(28)} = d^2 Vdot(2)/{dV(28)dV(28)}
    HESS(2) = D2A(21)+D2A(22)
    ! HESS(3) = d^2 Vdot(3)/{dV(26)dV(32)} = d^2 Vdot(3)/{dV(32)dV(26)}
    HESS(3) = D2A(32)
    ! HESS(4) = d^2 Vdot(4)/{dV(4)dV(26)} = d^2 Vdot(4)/{dV(26)dV(4)}
    HESS(4) = -D2A(48)
    ! HESS(5) = d^2 Vdot(4)/{dV(14)dV(27)} = d^2 Vdot(4)/{dV(27)dV(14)}
    HESS(5) = 0.4*D2A(46)
    ! HESS(6) = d^2 Vdot(4)/{dV(14)dV(30)} = d^2 Vdot(4)/{dV(30)dV(14)}
    HESS(6) = D2A(47)
    ! HESS(7) = d^2 Vdot(5)/{dV(5)dV(27)} = d^2 Vdot(5)/{dV(27)dV(5)}
    HESS(7) = -D2A(44)
    ! HESS(8) = d^2 Vdot(6)/{dV(26)dV(30)} = d^2 Vdot(6)/{dV(30)dV(26)}
    HESS(8) = D2A(10)
    ! HESS(9) = d^2 Vdot(7)/{dV(7)dV(27)} = d^2 Vdot(7)/{dV(27)dV(7)}
    HESS(9) = -D2A(49)
    ! HESS(10) = d^2 Vdot(8)/{dV(8)dV(31)} = d^2 Vdot(8)/{dV(31)dV(8)}
    HESS(10) = -D2A(59)
    ! HESS(11) = d^2 Vdot(8)/{dV(20)dV(27)} = d^2 Vdot(8)/{dV(27)dV(20)}
    HESS(11) = 0.13*D2A(35)
    ! HESS(12) = d^2 Vdot(8)/{dV(22)dV(27)} = d^2 Vdot(8)/{dV(27)dV(22)}
    HESS(12) = 0.13*D2A(54)
    ! HESS(13) = d^2 Vdot(8)/{dV(22)dV(30)} = d^2 Vdot(8)/{dV(30)dV(22)}
    HESS(13) = D2A(56)
    ! HESS(14) = d^2 Vdot(8)/{dV(23)dV(29)} = d^2 Vdot(8)/{dV(29)dV(23)}
    HESS(14) = 0.02*D2A(37)
    ! HESS(15) = d^2 Vdot(8)/{dV(23)dV(30)} = d^2 Vdot(8)/{dV(30)dV(23)}
    HESS(15) = 0.09*D2A(40)
    ! HESS(16) = d^2 Vdot(9)/{dV(9)dV(9)} = d^2 Vdot(9)/{dV(9)dV(9)}
    HESS(16) = -2*D2A(15)
    ! HESS(17) = d^2 Vdot(9)/{dV(9)dV(27)} = d^2 Vdot(9)/{dV(27)dV(9)}
    HESS(17) = -D2A(14)
    ! HESS(18) = d^2 Vdot(9)/{dV(26)dV(31)} = d^2 Vdot(9)/{dV(31)dV(26)}
    HESS(18) = 2*D2A(12)
    ! HESS(19) = d^2 Vdot(9)/{dV(27)dV(31)} = d^2 Vdot(9)/{dV(31)dV(27)}
    HESS(19) = D2A(13)
    ! HESS(20) = d^2 Vdot(10)/{dV(10)dV(27)} = d^2 Vdot(10)/{dV(27)dV(10)}
    HESS(20) = -D2A(20)
    ! HESS(21) = d^2 Vdot(10)/{dV(26)dV(28)} = d^2 Vdot(10)/{dV(28)dV(26)}
    HESS(21) = D2A(19)
    ! HESS(22) = d^2 Vdot(11)/{dV(5)dV(27)} = d^2 Vdot(11)/{dV(27)dV(5)}
    HESS(22) = 0.56*D2A(44)
    ! HESS(23) = d^2 Vdot(11)/{dV(7)dV(27)} = d^2 Vdot(11)/{dV(27)dV(7)}
    HESS(23) = 0.3*D2A(49)
    ! HESS(24) = d^2 Vdot(11)/{dV(11)dV(31)} = d^2 Vdot(11)/{dV(31)dV(11)}
    HESS(24) = -D2A(45)
    ! HESS(25) = d^2 Vdot(12)/{dV(12)dV(27)} = d^2 Vdot(12)/{dV(27)dV(12)}
    HESS(25) = -D2A(17)
    ! HESS(26) = d^2 Vdot(12)/{dV(14)dV(30)} = d^2 Vdot(12)/{dV(30)dV(14)}
    HESS(26) = D2A(47)
    ! HESS(27) = d^2 Vdot(12)/{dV(21)dV(30)} = d^2 Vdot(12)/{dV(30)dV(21)}
    HESS(27) = D2A(27)
    ! HESS(28) = d^2 Vdot(12)/{dV(24)dV(30)} = d^2 Vdot(12)/{dV(30)dV(24)}
    HESS(28) = D2A(30)
    ! HESS(29) = d^2 Vdot(12)/{dV(26)dV(27)} = d^2 Vdot(12)/{dV(27)dV(26)}
    HESS(29) = D2A(16)
    ! HESS(30) = d^2 Vdot(13)/{dV(13)dV(26)} = d^2 Vdot(13)/{dV(26)dV(13)}
    HESS(30) = -D2A(36)
    ! HESS(31) = d^2 Vdot(13)/{dV(20)dV(27)} = d^2 Vdot(13)/{dV(27)dV(20)}
    HESS(31) = 0.76*D2A(35)
    ! HESS(32) = d^2 Vdot(14)/{dV(5)dV(27)} = d^2 Vdot(14)/{dV(27)dV(5)}
    HESS(32) = 0.36*D2A(44)
    ! HESS(33) = d^2 Vdot(14)/{dV(7)dV(27)} = d^2 Vdot(14)/{dV(27)dV(7)}
    HESS(33) = 0.2*D2A(49)
    ! HESS(34) = d^2 Vdot(14)/{dV(14)dV(27)} = d^2 Vdot(14)/{dV(27)dV(14)}
    HESS(34) = -D2A(46)
    ! HESS(35) = d^2 Vdot(14)/{dV(14)dV(30)} = d^2 Vdot(14)/{dV(30)dV(14)}
    HESS(35) = -D2A(47)
    ! HESS(36) = d^2 Vdot(15)/{dV(7)dV(27)} = d^2 Vdot(15)/{dV(27)dV(7)}
    HESS(36) = 0.8*D2A(49)
    ! HESS(37) = d^2 Vdot(15)/{dV(15)dV(27)} = d^2 Vdot(15)/{dV(27)dV(15)}
    HESS(37) = -D2A(52)
    ! HESS(38) = d^2 Vdot(15)/{dV(19)dV(25)} = d^2 Vdot(15)/{dV(25)dV(19)}
    HESS(38) = 0.2*D2A(51)
    ! HESS(39) = d^2 Vdot(15)/{dV(22)dV(25)} = d^2 Vdot(15)/{dV(25)dV(22)}
    HESS(39) = 0.2*D2A(55)
    ! HESS(40) = d^2 Vdot(15)/{dV(22)dV(27)} = d^2 Vdot(15)/{dV(27)dV(22)}
    HESS(40) = 0.4*D2A(54)
    ! HESS(41) = d^2 Vdot(16)/{dV(16)dV(27)} = d^2 Vdot(16)/{dV(27)dV(16)}
    HESS(41) = -D2A(24)
    ! HESS(42) = d^2 Vdot(16)/{dV(17)dV(25)} = d^2 Vdot(16)/{dV(25)dV(17)}
    HESS(42) = 0.42*D2A(43)
    ! HESS(43) = d^2 Vdot(16)/{dV(17)dV(29)} = d^2 Vdot(16)/{dV(29)dV(17)}
    HESS(43) = D2A(41)
    ! HESS(44) = d^2 Vdot(16)/{dV(19)dV(25)} = d^2 Vdot(16)/{dV(25)dV(19)}
    HESS(44) = 0.69*D2A(51)
    ! HESS(45) = d^2 Vdot(16)/{dV(19)dV(27)} = d^2 Vdot(16)/{dV(27)dV(19)}
    HESS(45) = 2*D2A(50)
    ! HESS(46) = d^2 Vdot(16)/{dV(21)dV(27)} = d^2 Vdot(16)/{dV(27)dV(21)}
    HESS(46) = D2A(25)
    ! HESS(47) = d^2 Vdot(16)/{dV(21)dV(29)} = d^2 Vdot(16)/{dV(29)dV(21)}
    HESS(47) = D2A(26)
    ! HESS(48) = d^2 Vdot(16)/{dV(21)dV(30)} = d^2 Vdot(16)/{dV(30)dV(21)}
    HESS(48) = D2A(27)
    ! HESS(49) = d^2 Vdot(16)/{dV(22)dV(25)} = d^2 Vdot(16)/{dV(25)dV(22)}
    HESS(49) = 0.06*D2A(55)
    ! HESS(50) = d^2 Vdot(16)/{dV(22)dV(29)} = d^2 Vdot(16)/{dV(29)dV(22)}
    HESS(50) = 0.5*D2A(53)
    ! HESS(51) = d^2 Vdot(16)/{dV(23)dV(25)} = d^2 Vdot(16)/{dV(25)dV(23)}
    HESS(51) = 0.33*D2A(39)
    ! HESS(52) = d^2 Vdot(16)/{dV(23)dV(29)} = d^2 Vdot(16)/{dV(29)dV(23)}
    HESS(52) = 0.3*D2A(37)
    ! HESS(53) = d^2 Vdot(17)/{dV(17)dV(25)} = d^2 Vdot(17)/{dV(25)dV(17)}
    HESS(53) = -D2A(43)
    ! HESS(54) = d^2 Vdot(17)/{dV(17)dV(27)} = d^2 Vdot(17)/{dV(27)dV(17)}
    HESS(54) = -D2A(42)
    ! HESS(55) = d^2 Vdot(17)/{dV(17)dV(29)} = d^2 Vdot(17)/{dV(29)dV(17)}
    HESS(55) = -D2A(41)
    ! HESS(56) = d^2 Vdot(17)/{dV(22)dV(25)} = d^2 Vdot(17)/{dV(25)dV(22)}
    HESS(56) = 0.55*D2A(55)
    ! HESS(57) = d^2 Vdot(17)/{dV(22)dV(27)} = d^2 Vdot(17)/{dV(27)dV(22)}
    HESS(57) = D2A(54)
    ! HESS(58) = d^2 Vdot(17)/{dV(22)dV(29)} = d^2 Vdot(17)/{dV(29)dV(22)}
    HESS(58) = 0.45*D2A(53)
    ! HESS(59) = d^2 Vdot(18)/{dV(5)dV(27)} = d^2 Vdot(18)/{dV(27)dV(5)}
    HESS(59) = 0.08*D2A(44)
    ! HESS(60) = d^2 Vdot(18)/{dV(7)dV(27)} = d^2 Vdot(18)/{dV(27)dV(7)}
    HESS(60) = 0.5*D2A(49)
    ! HESS(61) = d^2 Vdot(18)/{dV(14)dV(27)} = d^2 Vdot(18)/{dV(27)dV(14)}
    HESS(61) = 0.6*D2A(46)
    ! HESS(62) = d^2 Vdot(18)/{dV(15)dV(27)} = d^2 Vdot(18)/{dV(27)dV(15)}
    HESS(62) = D2A(52)
    ! HESS(63) = d^2 Vdot(18)/{dV(17)dV(27)} = d^2 Vdot(18)/{dV(27)dV(17)}
    HESS(63) = D2A(42)
    ! HESS(64) = d^2 Vdot(18)/{dV(17)dV(29)} = d^2 Vdot(18)/{dV(29)dV(17)}
    HESS(64) = 0.7*D2A(41)
    ! HESS(65) = d^2 Vdot(18)/{dV(18)dV(18)} = d^2 Vdot(18)/{dV(18)dV(18)}
    HESS(65) = -2*D2A(58)
    ! HESS(66) = d^2 Vdot(18)/{dV(18)dV(31)} = d^2 Vdot(18)/{dV(31)dV(18)}
    HESS(66) = -D2A(57)
    ! HESS(67) = d^2 Vdot(18)/{dV(19)dV(25)} = d^2 Vdot(18)/{dV(25)dV(19)}
    HESS(67) = 0.03*D2A(51)
    ! HESS(68) = d^2 Vdot(18)/{dV(19)dV(27)} = d^2 Vdot(18)/{dV(27)dV(19)}
    HESS(68) = D2A(50)
    ! HESS(69) = d^2 Vdot(18)/{dV(20)dV(27)} = d^2 Vdot(18)/{dV(27)dV(20)}
    HESS(69) = 0.87*D2A(35)
    ! HESS(70) = d^2 Vdot(18)/{dV(22)dV(27)} = d^2 Vdot(18)/{dV(27)dV(22)}
    HESS(70) = D2A(54)
    ! HESS(71) = d^2 Vdot(18)/{dV(22)dV(29)} = d^2 Vdot(18)/{dV(29)dV(22)}
    HESS(71) = 0.5*D2A(53)
    ! HESS(72) = d^2 Vdot(18)/{dV(23)dV(25)} = d^2 Vdot(18)/{dV(25)dV(23)}
    HESS(72) = 0.22*D2A(39)
    ! HESS(73) = d^2 Vdot(18)/{dV(23)dV(27)} = d^2 Vdot(18)/{dV(27)dV(23)}
    HESS(73) = D2A(38)
    ! HESS(74) = d^2 Vdot(18)/{dV(23)dV(29)} = d^2 Vdot(18)/{dV(29)dV(23)}
    HESS(74) = 0.28*D2A(37)
    ! HESS(75) = d^2 Vdot(18)/{dV(23)dV(30)} = d^2 Vdot(18)/{dV(30)dV(23)}
    HESS(75) = 0.91*D2A(40)
    ! HESS(76) = d^2 Vdot(18)/{dV(28)dV(32)} = d^2 Vdot(18)/{dV(32)dV(28)}
    HESS(76) = 0.79*D2A(34)
    ! HESS(77) = d^2 Vdot(18)/{dV(31)dV(32)} = d^2 Vdot(18)/{dV(32)dV(31)}
    HESS(77) = D2A(31)
    ! HESS(78) = d^2 Vdot(18)/{dV(32)dV(32)} = d^2 Vdot(18)/{dV(32)dV(32)}
    HESS(78) = 2*D2A(33)
    ! HESS(79) = d^2 Vdot(19)/{dV(11)dV(31)} = d^2 Vdot(19)/{dV(31)dV(11)}
    HESS(79) = 0.9*D2A(45)
    ! HESS(80) = d^2 Vdot(19)/{dV(14)dV(27)} = d^2 Vdot(19)/{dV(27)dV(14)}
    HESS(80) = 0.3*D2A(46)
    ! HESS(81) = d^2 Vdot(19)/{dV(19)dV(25)} = d^2 Vdot(19)/{dV(25)dV(19)}
    HESS(81) = -D2A(51)
    ! HESS(82) = d^2 Vdot(19)/{dV(19)dV(27)} = d^2 Vdot(19)/{dV(27)dV(19)}
    HESS(82) = -D2A(50)
    ! HESS(83) = d^2 Vdot(20)/{dV(7)dV(27)} = d^2 Vdot(20)/{dV(27)dV(7)}
    HESS(83) = 1.1*D2A(49)
    ! HESS(84) = d^2 Vdot(20)/{dV(20)dV(27)} = d^2 Vdot(20)/{dV(27)dV(20)}
    HESS(84) = -1.11*D2A(35)
    ! HESS(85) = d^2 Vdot(20)/{dV(22)dV(25)} = d^2 Vdot(20)/{dV(25)dV(22)}
    HESS(85) = 0.1*D2A(55)
    ! HESS(86) = d^2 Vdot(20)/{dV(22)dV(29)} = d^2 Vdot(20)/{dV(29)dV(22)}
    HESS(86) = 0.9*D2A(53)
    ! HESS(87) = d^2 Vdot(20)/{dV(23)dV(25)} = d^2 Vdot(20)/{dV(25)dV(23)}
    HESS(87) = -D2A(39)
    ! HESS(88) = d^2 Vdot(20)/{dV(23)dV(27)} = d^2 Vdot(20)/{dV(27)dV(23)}
    HESS(88) = -D2A(38)
    ! HESS(89) = d^2 Vdot(20)/{dV(23)dV(29)} = d^2 Vdot(20)/{dV(29)dV(23)}
    HESS(89) = 0.22*D2A(37)
    ! HESS(90) = d^2 Vdot(20)/{dV(23)dV(30)} = d^2 Vdot(20)/{dV(30)dV(23)}
    HESS(90) = -D2A(40)
    ! HESS(91) = d^2 Vdot(21)/{dV(17)dV(25)} = d^2 Vdot(21)/{dV(25)dV(17)}
    HESS(91) = D2A(43)
    ! HESS(92) = d^2 Vdot(21)/{dV(17)dV(27)} = d^2 Vdot(21)/{dV(27)dV(17)}
    HESS(92) = 1.56*D2A(42)
    ! HESS(93) = d^2 Vdot(21)/{dV(17)dV(29)} = d^2 Vdot(21)/{dV(29)dV(17)}
    HESS(93) = D2A(41)
    ! HESS(94) = d^2 Vdot(21)/{dV(19)dV(25)} = d^2 Vdot(21)/{dV(25)dV(19)}
    HESS(94) = 0.7*D2A(51)
    ! HESS(95) = d^2 Vdot(21)/{dV(19)dV(27)} = d^2 Vdot(21)/{dV(27)dV(19)}
    HESS(95) = D2A(50)
    ! HESS(96) = d^2 Vdot(21)/{dV(21)dV(27)} = d^2 Vdot(21)/{dV(27)dV(21)}
    HESS(96) = -D2A(25)
    ! HESS(97) = d^2 Vdot(21)/{dV(21)dV(29)} = d^2 Vdot(21)/{dV(29)dV(21)}
    HESS(97) = -D2A(26)
    ! HESS(98) = d^2 Vdot(21)/{dV(21)dV(30)} = d^2 Vdot(21)/{dV(30)dV(21)}
    HESS(98) = -D2A(27)
    ! HESS(99) = d^2 Vdot(21)/{dV(22)dV(25)} = d^2 Vdot(21)/{dV(25)dV(22)}
    HESS(99) = D2A(55)
    ! HESS(100) = d^2 Vdot(21)/{dV(22)dV(27)} = d^2 Vdot(21)/{dV(27)dV(22)}
    HESS(100) = D2A(54)
    ! HESS(101) = d^2 Vdot(21)/{dV(23)dV(25)} = d^2 Vdot(21)/{dV(25)dV(23)}
    HESS(101) = 0.74*D2A(39)
    ! HESS(102) = d^2 Vdot(21)/{dV(23)dV(27)} = d^2 Vdot(21)/{dV(27)dV(23)}
    HESS(102) = D2A(38)
    ! HESS(103) = d^2 Vdot(21)/{dV(23)dV(29)} = d^2 Vdot(21)/{dV(29)dV(23)}
    HESS(103) = 0.2*D2A(37)
    ! HESS(104) = d^2 Vdot(21)/{dV(23)dV(30)} = d^2 Vdot(21)/{dV(30)dV(23)}
    HESS(104) = D2A(40)
    ! HESS(105) = d^2 Vdot(21)/{dV(28)dV(32)} = d^2 Vdot(21)/{dV(32)dV(28)}
    HESS(105) = 0.79*D2A(34)
    ! HESS(106) = d^2 Vdot(21)/{dV(31)dV(32)} = d^2 Vdot(21)/{dV(32)dV(31)}
    HESS(106) = D2A(31)
    ! HESS(107) = d^2 Vdot(21)/{dV(32)dV(32)} = d^2 Vdot(21)/{dV(32)dV(32)}
    HESS(107) = 2*D2A(33)
    ! HESS(108) = d^2 Vdot(22)/{dV(22)dV(25)} = d^2 Vdot(22)/{dV(25)dV(22)}
    HESS(108) = -D2A(55)
    ! HESS(109) = d^2 Vdot(22)/{dV(22)dV(27)} = d^2 Vdot(22)/{dV(27)dV(22)}
    HESS(109) = -D2A(54)
    ! HESS(110) = d^2 Vdot(22)/{dV(22)dV(29)} = d^2 Vdot(22)/{dV(29)dV(22)}
    HESS(110) = -D2A(53)
    ! HESS(111) = d^2 Vdot(22)/{dV(22)dV(30)} = d^2 Vdot(22)/{dV(30)dV(22)}
    HESS(111) = -D2A(56)
    ! HESS(112) = d^2 Vdot(23)/{dV(22)dV(29)} = d^2 Vdot(23)/{dV(29)dV(22)}
    HESS(112) = 0.55*D2A(53)
    ! HESS(113) = d^2 Vdot(23)/{dV(23)dV(25)} = d^2 Vdot(23)/{dV(25)dV(23)}
    HESS(113) = -D2A(39)
    ! HESS(114) = d^2 Vdot(23)/{dV(23)dV(27)} = d^2 Vdot(23)/{dV(27)dV(23)}
    HESS(114) = -D2A(38)
    ! HESS(115) = d^2 Vdot(23)/{dV(23)dV(29)} = d^2 Vdot(23)/{dV(29)dV(23)}
    HESS(115) = -D2A(37)
    ! HESS(116) = d^2 Vdot(23)/{dV(23)dV(30)} = d^2 Vdot(23)/{dV(30)dV(23)}
    HESS(116) = -D2A(40)
    ! HESS(117) = d^2 Vdot(24)/{dV(17)dV(27)} = d^2 Vdot(24)/{dV(27)dV(17)}
    HESS(117) = 0.22*D2A(42)
    ! HESS(118) = d^2 Vdot(24)/{dV(19)dV(25)} = d^2 Vdot(24)/{dV(25)dV(19)}
    HESS(118) = 0.03*D2A(51)
    ! HESS(119) = d^2 Vdot(24)/{dV(20)dV(27)} = d^2 Vdot(24)/{dV(27)dV(20)}
    HESS(119) = 0.11*D2A(35)
    ! HESS(120) = d^2 Vdot(24)/{dV(22)dV(25)} = d^2 Vdot(24)/{dV(25)dV(22)}
    HESS(120) = 0.4*D2A(55)
    ! HESS(121) = d^2 Vdot(24)/{dV(22)dV(27)} = d^2 Vdot(24)/{dV(27)dV(22)}
    HESS(121) = 0.2*D2A(54)
    ! HESS(122) = d^2 Vdot(24)/{dV(22)dV(29)} = d^2 Vdot(24)/{dV(29)dV(22)}
    HESS(122) = 0.8*D2A(53)
    ! HESS(123) = d^2 Vdot(24)/{dV(23)dV(25)} = d^2 Vdot(24)/{dV(25)dV(23)}
    HESS(123) = 0.5*D2A(39)
    ! HESS(124) = d^2 Vdot(24)/{dV(23)dV(27)} = d^2 Vdot(24)/{dV(27)dV(23)}
    HESS(124) = D2A(38)
    ! HESS(125) = d^2 Vdot(24)/{dV(23)dV(29)} = d^2 Vdot(24)/{dV(29)dV(23)}
    HESS(125) = 0.63*D2A(37)
    ! HESS(126) = d^2 Vdot(24)/{dV(23)dV(30)} = d^2 Vdot(24)/{dV(30)dV(23)}
    HESS(126) = D2A(40)
    ! HESS(127) = d^2 Vdot(24)/{dV(24)dV(27)} = d^2 Vdot(24)/{dV(27)dV(24)}
    HESS(127) = -D2A(29)
    ! HESS(128) = d^2 Vdot(24)/{dV(24)dV(29)} = d^2 Vdot(24)/{dV(29)dV(24)}
    HESS(128) = -D2A(28)
    ! HESS(129) = d^2 Vdot(24)/{dV(24)dV(30)} = d^2 Vdot(24)/{dV(30)dV(24)}
    HESS(129) = -D2A(30)
    ! HESS(130) = d^2 Vdot(25)/{dV(17)dV(25)} = d^2 Vdot(25)/{dV(25)dV(17)}
    HESS(130) = -D2A(43)
    ! HESS(131) = d^2 Vdot(25)/{dV(19)dV(25)} = d^2 Vdot(25)/{dV(25)dV(19)}
    HESS(131) = -D2A(51)
    ! HESS(132) = d^2 Vdot(25)/{dV(22)dV(25)} = d^2 Vdot(25)/{dV(25)dV(22)}
    HESS(132) = -D2A(55)
    ! HESS(133) = d^2 Vdot(25)/{dV(23)dV(25)} = d^2 Vdot(25)/{dV(25)dV(23)}
    HESS(133) = -D2A(39)
    ! HESS(134) = d^2 Vdot(25)/{dV(25)dV(26)} = d^2 Vdot(25)/{dV(26)dV(25)}
    HESS(134) = -D2A(5)
    ! HESS(135) = d^2 Vdot(25)/{dV(25)dV(27)} = d^2 Vdot(25)/{dV(27)dV(25)}
    HESS(135) = -D2A(6)
    ! HESS(136) = d^2 Vdot(25)/{dV(25)dV(28)} = d^2 Vdot(25)/{dV(28)dV(25)}
    HESS(136) = -D2A(7)
    ! HESS(137) = d^2 Vdot(25)/{dV(25)dV(31)} = d^2 Vdot(25)/{dV(31)dV(25)}
    HESS(137) = -D2A(1)
    ! HESS(138) = d^2 Vdot(26)/{dV(4)dV(26)} = d^2 Vdot(26)/{dV(26)dV(4)}
    HESS(138) = -D2A(48)
    ! HESS(139) = d^2 Vdot(26)/{dV(9)dV(9)} = d^2 Vdot(26)/{dV(9)dV(9)}
    HESS(139) = D2A(15)
    ! HESS(140) = d^2 Vdot(26)/{dV(9)dV(27)} = d^2 Vdot(26)/{dV(27)dV(9)}
    HESS(140) = D2A(14)
    ! HESS(141) = d^2 Vdot(26)/{dV(10)dV(27)} = d^2 Vdot(26)/{dV(27)dV(10)}
    HESS(141) = D2A(20)
    ! HESS(142) = d^2 Vdot(26)/{dV(11)dV(31)} = d^2 Vdot(26)/{dV(31)dV(11)}
    HESS(142) = 0.9*D2A(45)
    ! HESS(143) = d^2 Vdot(26)/{dV(13)dV(26)} = d^2 Vdot(26)/{dV(26)dV(13)}
    HESS(143) = -D2A(36)
    ! HESS(144) = d^2 Vdot(26)/{dV(18)dV(31)} = d^2 Vdot(26)/{dV(31)dV(18)}
    HESS(144) = D2A(57)
    ! HESS(145) = d^2 Vdot(26)/{dV(23)dV(30)} = d^2 Vdot(26)/{dV(30)dV(23)}
    HESS(145) = D2A(40)
    ! HESS(146) = d^2 Vdot(26)/{dV(25)dV(26)} = d^2 Vdot(26)/{dV(26)dV(25)}
    HESS(146) = -D2A(5)
    ! HESS(147) = d^2 Vdot(26)/{dV(25)dV(31)} = d^2 Vdot(26)/{dV(31)dV(25)}
    HESS(147) = D2A(1)
    ! HESS(148) = d^2 Vdot(26)/{dV(26)dV(27)} = d^2 Vdot(26)/{dV(27)dV(26)}
    HESS(148) = -D2A(16)
    ! HESS(149) = d^2 Vdot(26)/{dV(26)dV(28)} = d^2 Vdot(26)/{dV(28)dV(26)}
    HESS(149) = -D2A(19)
    ! HESS(150) = d^2 Vdot(26)/{dV(26)dV(29)} = d^2 Vdot(26)/{dV(29)dV(26)}
    HESS(150) = -D2A(2)-D2A(3)
    ! HESS(151) = d^2 Vdot(26)/{dV(26)dV(30)} = d^2 Vdot(26)/{dV(30)dV(26)}
    HESS(151) = -D2A(10)
    ! HESS(152) = d^2 Vdot(26)/{dV(26)dV(31)} = d^2 Vdot(26)/{dV(31)dV(26)}
    HESS(152) = -D2A(12)
    ! HESS(153) = d^2 Vdot(26)/{dV(26)dV(32)} = d^2 Vdot(26)/{dV(32)dV(26)}
    HESS(153) = -D2A(32)
    ! HESS(154) = d^2 Vdot(26)/{dV(28)dV(31)} = d^2 Vdot(26)/{dV(31)dV(28)}
    HESS(154) = D2A(18)
    ! HESS(155) = d^2 Vdot(26)/{dV(29)dV(31)} = d^2 Vdot(26)/{dV(31)dV(29)}
    HESS(155) = D2A(4)
    ! HESS(156) = d^2 Vdot(26)/{dV(30)dV(31)} = d^2 Vdot(26)/{dV(31)dV(30)}
    HESS(156) = 2*D2A(8)
    ! HESS(157) = d^2 Vdot(26)/{dV(31)dV(31)} = d^2 Vdot(26)/{dV(31)dV(31)}
    HESS(157) = 2*D2A(11)
    ! HESS(158) = d^2 Vdot(26)/{dV(31)dV(32)} = d^2 Vdot(26)/{dV(32)dV(31)}
    HESS(158) = D2A(31)
    ! HESS(159) = d^2 Vdot(27)/{dV(2)dV(27)} = d^2 Vdot(27)/{dV(27)dV(2)}
    HESS(159) = -D2A(23)
    ! HESS(160) = d^2 Vdot(27)/{dV(5)dV(27)} = d^2 Vdot(27)/{dV(27)dV(5)}
    HESS(160) = -D2A(44)
    ! HESS(161) = d^2 Vdot(27)/{dV(7)dV(27)} = d^2 Vdot(27)/{dV(27)dV(7)}
    HESS(161) = -D2A(49)
    ! HESS(162) = d^2 Vdot(27)/{dV(9)dV(27)} = d^2 Vdot(27)/{dV(27)dV(9)}
    HESS(162) = -D2A(14)
    ! HESS(163) = d^2 Vdot(27)/{dV(10)dV(27)} = d^2 Vdot(27)/{dV(27)dV(10)}
    HESS(163) = -D2A(20)
    ! HESS(164) = d^2 Vdot(27)/{dV(12)dV(27)} = d^2 Vdot(27)/{dV(27)dV(12)}
    HESS(164) = -D2A(17)
    ! HESS(165) = d^2 Vdot(27)/{dV(14)dV(27)} = d^2 Vdot(27)/{dV(27)dV(14)}
    HESS(165) = -D2A(46)
    ! HESS(166) = d^2 Vdot(27)/{dV(15)dV(27)} = d^2 Vdot(27)/{dV(27)dV(15)}
    HESS(166) = -D2A(52)
    ! HESS(167) = d^2 Vdot(27)/{dV(16)dV(27)} = d^2 Vdot(27)/{dV(27)dV(16)}
    HESS(167) = -D2A(24)
    ! HESS(168) = d^2 Vdot(27)/{dV(17)dV(27)} = d^2 Vdot(27)/{dV(27)dV(17)}
    HESS(168) = -D2A(42)
    ! HESS(169) = d^2 Vdot(27)/{dV(17)dV(29)} = d^2 Vdot(27)/{dV(29)dV(17)}
    HESS(169) = 0.3*D2A(41)
    ! HESS(170) = d^2 Vdot(27)/{dV(19)dV(25)} = d^2 Vdot(27)/{dV(25)dV(19)}
    HESS(170) = 0.08*D2A(51)
    ! HESS(171) = d^2 Vdot(27)/{dV(19)dV(27)} = d^2 Vdot(27)/{dV(27)dV(19)}
    HESS(171) = -D2A(50)
    ! HESS(172) = d^2 Vdot(27)/{dV(20)dV(27)} = d^2 Vdot(27)/{dV(27)dV(20)}
    HESS(172) = -D2A(35)
    ! HESS(173) = d^2 Vdot(27)/{dV(21)dV(27)} = d^2 Vdot(27)/{dV(27)dV(21)}
    HESS(173) = -D2A(25)
    ! HESS(174) = d^2 Vdot(27)/{dV(21)dV(29)} = d^2 Vdot(27)/{dV(29)dV(21)}
    HESS(174) = D2A(26)
    ! HESS(175) = d^2 Vdot(27)/{dV(22)dV(25)} = d^2 Vdot(27)/{dV(25)dV(22)}
    HESS(175) = 0.1*D2A(55)
    ! HESS(176) = d^2 Vdot(27)/{dV(22)dV(27)} = d^2 Vdot(27)/{dV(27)dV(22)}
    HESS(176) = -D2A(54)
    ! HESS(177) = d^2 Vdot(27)/{dV(23)dV(25)} = d^2 Vdot(27)/{dV(25)dV(23)}
    HESS(177) = 0.1*D2A(39)
    ! HESS(178) = d^2 Vdot(27)/{dV(23)dV(27)} = d^2 Vdot(27)/{dV(27)dV(23)}
    HESS(178) = -D2A(38)
    ! HESS(179) = d^2 Vdot(27)/{dV(23)dV(29)} = d^2 Vdot(27)/{dV(29)dV(23)}
    HESS(179) = 0.2*D2A(37)
    ! HESS(180) = d^2 Vdot(27)/{dV(24)dV(27)} = d^2 Vdot(27)/{dV(27)dV(24)}
    HESS(180) = -D2A(29)
    ! HESS(181) = d^2 Vdot(27)/{dV(24)dV(29)} = d^2 Vdot(27)/{dV(29)dV(24)}
    HESS(181) = D2A(28)
    ! HESS(182) = d^2 Vdot(27)/{dV(25)dV(27)} = d^2 Vdot(27)/{dV(27)dV(25)}
    HESS(182) = -D2A(6)
    ! HESS(183) = d^2 Vdot(27)/{dV(25)dV(28)} = d^2 Vdot(27)/{dV(28)dV(25)}
    HESS(183) = D2A(7)
    ! HESS(184) = d^2 Vdot(27)/{dV(26)dV(27)} = d^2 Vdot(27)/{dV(27)dV(26)}
    HESS(184) = -D2A(16)
    ! HESS(185) = d^2 Vdot(27)/{dV(27)dV(31)} = d^2 Vdot(27)/{dV(31)dV(27)}
    HESS(185) = -D2A(13)
    ! HESS(186) = d^2 Vdot(27)/{dV(28)dV(31)} = d^2 Vdot(27)/{dV(31)dV(28)}
    HESS(186) = D2A(18)
    ! HESS(187) = d^2 Vdot(27)/{dV(28)dV(32)} = d^2 Vdot(27)/{dV(32)dV(28)}
    HESS(187) = 0.79*D2A(34)
    ! HESS(188) = d^2 Vdot(28)/{dV(2)dV(27)} = d^2 Vdot(28)/{dV(27)dV(2)}
    HESS(188) = D2A(23)
    ! HESS(189) = d^2 Vdot(28)/{dV(5)dV(27)} = d^2 Vdot(28)/{dV(27)dV(5)}
    HESS(189) = 0.44*D2A(44)
    ! HESS(190) = d^2 Vdot(28)/{dV(7)dV(27)} = d^2 Vdot(28)/{dV(27)dV(7)}
    HESS(190) = 0.7*D2A(49)
    ! HESS(191) = d^2 Vdot(28)/{dV(11)dV(31)} = d^2 Vdot(28)/{dV(31)dV(11)}
    HESS(191) = 0.9*D2A(45)
    ! HESS(192) = d^2 Vdot(28)/{dV(14)dV(27)} = d^2 Vdot(28)/{dV(27)dV(14)}
    HESS(192) = 0.6*D2A(46)
    ! HESS(193) = d^2 Vdot(28)/{dV(16)dV(27)} = d^2 Vdot(28)/{dV(27)dV(16)}
    HESS(193) = D2A(24)
    ! HESS(194) = d^2 Vdot(28)/{dV(17)dV(25)} = d^2 Vdot(28)/{dV(25)dV(17)}
    HESS(194) = 0.12*D2A(43)
    ! HESS(195) = d^2 Vdot(28)/{dV(17)dV(27)} = d^2 Vdot(28)/{dV(27)dV(17)}
    HESS(195) = D2A(42)
    ! HESS(196) = d^2 Vdot(28)/{dV(17)dV(29)} = d^2 Vdot(28)/{dV(29)dV(17)}
    HESS(196) = 1.7*D2A(41)
    ! HESS(197) = d^2 Vdot(28)/{dV(19)dV(25)} = d^2 Vdot(28)/{dV(25)dV(19)}
    HESS(197) = 0.76*D2A(51)
    ! HESS(198) = d^2 Vdot(28)/{dV(19)dV(27)} = d^2 Vdot(28)/{dV(27)dV(19)}
    HESS(198) = 2*D2A(50)
    ! HESS(199) = d^2 Vdot(28)/{dV(20)dV(27)} = d^2 Vdot(28)/{dV(27)dV(20)}
    HESS(199) = 0.11*D2A(35)
    ! HESS(200) = d^2 Vdot(28)/{dV(21)dV(27)} = d^2 Vdot(28)/{dV(27)dV(21)}
    HESS(200) = D2A(25)
    ! HESS(201) = d^2 Vdot(28)/{dV(21)dV(29)} = d^2 Vdot(28)/{dV(29)dV(21)}
    HESS(201) = D2A(26)
    ! HESS(202) = d^2 Vdot(28)/{dV(21)dV(30)} = d^2 Vdot(28)/{dV(30)dV(21)}
    HESS(202) = D2A(27)
    ! HESS(203) = d^2 Vdot(28)/{dV(22)dV(25)} = d^2 Vdot(28)/{dV(25)dV(22)}
    HESS(203) = 0.44*D2A(55)
    ! HESS(204) = d^2 Vdot(28)/{dV(22)dV(27)} = d^2 Vdot(28)/{dV(27)dV(22)}
    HESS(204) = 0.67*D2A(54)
    ! HESS(205) = d^2 Vdot(28)/{dV(22)dV(29)} = d^2 Vdot(28)/{dV(29)dV(22)}
    HESS(205) = 0.6*D2A(53)
    ! HESS(206) = d^2 Vdot(28)/{dV(23)dV(25)} = d^2 Vdot(28)/{dV(25)dV(23)}
    HESS(206) = 0.44*D2A(39)
    ! HESS(207) = d^2 Vdot(28)/{dV(23)dV(27)} = d^2 Vdot(28)/{dV(27)dV(23)}
    HESS(207) = D2A(38)
    ! HESS(208) = d^2 Vdot(28)/{dV(23)dV(29)} = d^2 Vdot(28)/{dV(29)dV(23)}
    HESS(208) = 0.38*D2A(37)
    ! HESS(209) = d^2 Vdot(28)/{dV(25)dV(27)} = d^2 Vdot(28)/{dV(27)dV(25)}
    HESS(209) = D2A(6)
    ! HESS(210) = d^2 Vdot(28)/{dV(25)dV(28)} = d^2 Vdot(28)/{dV(28)dV(25)}
    HESS(210) = -D2A(7)
    ! HESS(211) = d^2 Vdot(28)/{dV(26)dV(28)} = d^2 Vdot(28)/{dV(28)dV(26)}
    HESS(211) = -D2A(19)
    ! HESS(212) = d^2 Vdot(28)/{dV(28)dV(28)} = d^2 Vdot(28)/{dV(28)dV(28)}
    HESS(212) = -2*D2A(21)-2*D2A(22)
    ! HESS(213) = d^2 Vdot(28)/{dV(28)dV(31)} = d^2 Vdot(28)/{dV(31)dV(28)}
    HESS(213) = -D2A(18)
    ! HESS(214) = d^2 Vdot(28)/{dV(28)dV(32)} = d^2 Vdot(28)/{dV(32)dV(28)}
    HESS(214) = -0.21*D2A(34)
    ! HESS(215) = d^2 Vdot(28)/{dV(31)dV(32)} = d^2 Vdot(28)/{dV(32)dV(31)}
    HESS(215) = D2A(31)
    ! HESS(216) = d^2 Vdot(28)/{dV(32)dV(32)} = d^2 Vdot(28)/{dV(32)dV(32)}
    HESS(216) = 2*D2A(33)
    ! HESS(217) = d^2 Vdot(29)/{dV(17)dV(29)} = d^2 Vdot(29)/{dV(29)dV(17)}
    HESS(217) = -D2A(41)
    ! HESS(218) = d^2 Vdot(29)/{dV(21)dV(29)} = d^2 Vdot(29)/{dV(29)dV(21)}
    HESS(218) = -D2A(26)
    ! HESS(219) = d^2 Vdot(29)/{dV(22)dV(29)} = d^2 Vdot(29)/{dV(29)dV(22)}
    HESS(219) = -D2A(53)
    ! HESS(220) = d^2 Vdot(29)/{dV(23)dV(29)} = d^2 Vdot(29)/{dV(29)dV(23)}
    HESS(220) = -D2A(37)
    ! HESS(221) = d^2 Vdot(29)/{dV(24)dV(29)} = d^2 Vdot(29)/{dV(29)dV(24)}
    HESS(221) = -D2A(28)
    ! HESS(222) = d^2 Vdot(29)/{dV(26)dV(29)} = d^2 Vdot(29)/{dV(29)dV(26)}
    HESS(222) = -D2A(2)-D2A(3)
    ! HESS(223) = d^2 Vdot(29)/{dV(29)dV(31)} = d^2 Vdot(29)/{dV(31)dV(29)}
    HESS(223) = -D2A(4)
    ! HESS(224) = d^2 Vdot(30)/{dV(12)dV(27)} = d^2 Vdot(30)/{dV(27)dV(12)}
    HESS(224) = D2A(17)
    ! HESS(225) = d^2 Vdot(30)/{dV(14)dV(30)} = d^2 Vdot(30)/{dV(30)dV(14)}
    HESS(225) = -D2A(47)
    ! HESS(226) = d^2 Vdot(30)/{dV(21)dV(30)} = d^2 Vdot(30)/{dV(30)dV(21)}
    HESS(226) = -D2A(27)
    ! HESS(227) = d^2 Vdot(30)/{dV(22)dV(30)} = d^2 Vdot(30)/{dV(30)dV(22)}
    HESS(227) = -D2A(56)
    ! HESS(228) = d^2 Vdot(30)/{dV(23)dV(30)} = d^2 Vdot(30)/{dV(30)dV(23)}
    HESS(228) = -D2A(40)
    ! HESS(229) = d^2 Vdot(30)/{dV(24)dV(30)} = d^2 Vdot(30)/{dV(30)dV(24)}
    HESS(229) = -D2A(30)
    ! HESS(230) = d^2 Vdot(30)/{dV(25)dV(26)} = d^2 Vdot(30)/{dV(26)dV(25)}
    HESS(230) = D2A(5)
    ! HESS(231) = d^2 Vdot(30)/{dV(26)dV(29)} = d^2 Vdot(30)/{dV(29)dV(26)}
    HESS(231) = D2A(3)
    ! HESS(232) = d^2 Vdot(30)/{dV(26)dV(30)} = d^2 Vdot(30)/{dV(30)dV(26)}
    HESS(232) = -D2A(9)-D2A(10)
    ! HESS(233) = d^2 Vdot(30)/{dV(30)dV(31)} = d^2 Vdot(30)/{dV(31)dV(30)}
    HESS(233) = -D2A(8)
    ! HESS(234) = d^2 Vdot(31)/{dV(8)dV(31)} = d^2 Vdot(31)/{dV(31)dV(8)}
    HESS(234) = -D2A(59)
    ! HESS(235) = d^2 Vdot(31)/{dV(9)dV(9)} = d^2 Vdot(31)/{dV(9)dV(9)}
    HESS(235) = D2A(15)
    ! HESS(236) = d^2 Vdot(31)/{dV(11)dV(31)} = d^2 Vdot(31)/{dV(31)dV(11)}
    HESS(236) = -D2A(45)
    ! HESS(237) = d^2 Vdot(31)/{dV(18)dV(31)} = d^2 Vdot(31)/{dV(31)dV(18)}
    HESS(237) = -D2A(57)
    ! HESS(238) = d^2 Vdot(31)/{dV(25)dV(31)} = d^2 Vdot(31)/{dV(31)dV(25)}
    HESS(238) = -D2A(1)
    ! HESS(239) = d^2 Vdot(31)/{dV(26)dV(29)} = d^2 Vdot(31)/{dV(29)dV(26)}
    HESS(239) = D2A(2)
    ! HESS(240) = d^2 Vdot(31)/{dV(26)dV(30)} = d^2 Vdot(31)/{dV(30)dV(26)}
    HESS(240) = D2A(9)
    ! HESS(241) = d^2 Vdot(31)/{dV(26)dV(31)} = d^2 Vdot(31)/{dV(31)dV(26)}
    HESS(241) = -D2A(12)
    ! HESS(242) = d^2 Vdot(31)/{dV(27)dV(31)} = d^2 Vdot(31)/{dV(31)dV(27)}
    HESS(242) = -D2A(13)
    ! HESS(243) = d^2 Vdot(31)/{dV(28)dV(31)} = d^2 Vdot(31)/{dV(31)dV(28)}
    HESS(243) = -D2A(18)
    ! HESS(244) = d^2 Vdot(31)/{dV(29)dV(31)} = d^2 Vdot(31)/{dV(31)dV(29)}
    HESS(244) = -D2A(4)
    ! HESS(245) = d^2 Vdot(31)/{dV(30)dV(31)} = d^2 Vdot(31)/{dV(31)dV(30)}
    HESS(245) = -D2A(8)
    ! HESS(246) = d^2 Vdot(31)/{dV(31)dV(31)} = d^2 Vdot(31)/{dV(31)dV(31)}
    HESS(246) = -2*D2A(11)
    ! HESS(247) = d^2 Vdot(31)/{dV(31)dV(32)} = d^2 Vdot(31)/{dV(32)dV(31)}
    HESS(247) = -D2A(31)
    ! HESS(248) = d^2 Vdot(32)/{dV(15)dV(27)} = d^2 Vdot(32)/{dV(27)dV(15)}
    HESS(248) = D2A(52)
    ! HESS(249) = d^2 Vdot(32)/{dV(19)dV(25)} = d^2 Vdot(32)/{dV(25)dV(19)}
    HESS(249) = 0.62*D2A(51)
    ! HESS(250) = d^2 Vdot(32)/{dV(19)dV(27)} = d^2 Vdot(32)/{dV(27)dV(19)}
    HESS(250) = D2A(50)
    ! HESS(251) = d^2 Vdot(32)/{dV(22)dV(27)} = d^2 Vdot(32)/{dV(27)dV(22)}
    HESS(251) = 0.2*D2A(54)
    ! HESS(252) = d^2 Vdot(32)/{dV(24)dV(27)} = d^2 Vdot(32)/{dV(27)dV(24)}
    HESS(252) = D2A(29)
    ! HESS(253) = d^2 Vdot(32)/{dV(24)dV(29)} = d^2 Vdot(32)/{dV(29)dV(24)}
    HESS(253) = D2A(28)
    ! HESS(254) = d^2 Vdot(32)/{dV(24)dV(30)} = d^2 Vdot(32)/{dV(30)dV(24)}
    HESS(254) = D2A(30)
    ! HESS(255) = d^2 Vdot(32)/{dV(26)dV(32)} = d^2 Vdot(32)/{dV(32)dV(26)}
    HESS(255) = -D2A(32)
    ! HESS(256) = d^2 Vdot(32)/{dV(28)dV(32)} = d^2 Vdot(32)/{dV(32)dV(28)}
    HESS(256) = -D2A(34)
    ! HESS(257) = d^2 Vdot(32)/{dV(31)dV(32)} = d^2 Vdot(32)/{dV(32)dV(31)}
    HESS(257) = -D2A(31)
    ! HESS(258) = d^2 Vdot(32)/{dV(32)dV(32)} = d^2 Vdot(32)/{dV(32)dV(32)}
    HESS(258) = -2*D2A(33)
      
    END SUBROUTINE Hessian

    ! End of Hessian function
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ! 
    ! CBM4_HessTR_Vec - Hessian transposed times user vectors
    !   Arguments :
    !      HESS      - Hessian of Var (i.e. the 3-tensor d Jac / d Var)
    !      U1        - User vector
    !      U2        - User vector
    !      HTU       - Transposed Hessian times user vectors: (Hess x U2)^T * U1 =
    !      [d (Jac^T*U1)/d Var] * U2
    ! 
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    SUBROUTINE CBM4_HessTR_Vec ( HESS, U1, U2, HTU )

    ! HESS - Hessian of Var (i.e. the 3-tensor d Jac / d Var)
    DOUBLE PRECISION :: HESS(NHESS)
    ! U1 - User vector
    DOUBLE PRECISION :: U1(NVAR)
    ! U2 - User vector
    DOUBLE PRECISION :: U2(NVAR)
    ! HTU - Transposed Hessian times user vectors: (Hess x U2)^T * U1 = [d
    ! (Jac^T*U1)/d Var] * U2
    DOUBLE PRECISION :: HTU(NVAR)

    ! Compute the vector HTU =(Hess x U2)^T * U1 = d (Jac^T*U1)/d Var * U2
    HTU(1) = 0
    HTU(2) = HESS(1)*(U1(2)*U2(27))+HESS(159)*(U1(27)*U2(27))+HESS(188)*(U1(28)*U2(27))
    HTU(3) = 0
    HTU(4) = HESS(4)*(U1(4)*U2(26))+HESS(138)*(U1(26)*U2(26))  
    HTU(5) = HESS(7)*(U1(5)*U2(27))+HESS(22)*(U1(11)*U2(27))+HESS(32)*(U1(14)*U2(27))+HESS(59)*(U1(18)*U2(27))+HESS(160)&
             &*(U1(27)*U2(27))+HESS(189)*(U1(28)*U2(27))
    HTU(6) = 0
    HTU(7) = HESS(9)*(U1(7)*U2(27))+HESS(23)*(U1(11)*U2(27))+HESS(33)*(U1(14)*U2(27))+HESS(36)*(U1(15)*U2(27))+HESS(60)&
             &*(U1(18)*U2(27))+HESS(83)*(U1(20)*U2(27))+HESS(161)*(U1(27)*U2(27))+HESS(190)*(U1(28)*U2(27))
    HTU(8) = HESS(10)*(U1(8)*U2(31))+HESS(234)*(U1(31)*U2(31))
    HTU(9) = HESS(16)*(U1(9)*U2(9))+HESS(17)*(U1(9)*U2(27))+HESS(139)*(U1(26)*U2(9))+HESS(140)*(U1(26)*U2(27))+HESS(162)&
             &*(U1(27)*U2(27))+HESS(235)*(U1(31)*U2(9))
    HTU(10) = HESS(20)*(U1(10)*U2(27))+HESS(141)*(U1(26)*U2(27))+HESS(163)*(U1(27)*U2(27))
    HTU(11) = HESS(24)*(U1(11)*U2(31))+HESS(79)*(U1(19)*U2(31))+HESS(142)*(U1(26)*U2(31))+HESS(191)*(U1(28)*U2(31))&
              &+HESS(236)*(U1(31)*U2(31))
    HTU(12) = HESS(25)*(U1(12)*U2(27))+HESS(164)*(U1(27)*U2(27))+HESS(224)*(U1(30)*U2(27))
    HTU(13) = HESS(30)*(U1(13)*U2(26))+HESS(143)*(U1(26)*U2(26))
    HTU(14) = HESS(5)*(U1(4)*U2(27))+HESS(6)*(U1(4)*U2(30))+HESS(26)*(U1(12)*U2(30))+HESS(34)*(U1(14)*U2(27))+HESS(35)&
              &*(U1(14)*U2(30))+HESS(61)*(U1(18)*U2(27))+HESS(80)*(U1(19)*U2(27))+HESS(165)*(U1(27)*U2(27))+HESS(192)&
              &*(U1(28)*U2(27))+HESS(225)*(U1(30)*U2(30))
    HTU(15) = HESS(37)*(U1(15)*U2(27))+HESS(62)*(U1(18)*U2(27))+HESS(166)*(U1(27)*U2(27))+HESS(248)*(U1(32)*U2(27))
    HTU(16) = HESS(41)*(U1(16)*U2(27))+HESS(167)*(U1(27)*U2(27))+HESS(193)*(U1(28)*U2(27))
    HTU(17) = HESS(42)*(U1(16)*U2(25))+HESS(43)*(U1(16)*U2(29))+HESS(53)*(U1(17)*U2(25))+HESS(54)*(U1(17)*U2(27))+HESS(55)&
              &*(U1(17)*U2(29))+HESS(63)*(U1(18)*U2(27))+HESS(64)*(U1(18)*U2(29))+HESS(91)*(U1(21)*U2(25))+HESS(92)*(U1(21)&
              &*U2(27))+HESS(93)*(U1(21)*U2(29))+HESS(117)*(U1(24)*U2(27))+HESS(130)*(U1(25)*U2(25))+HESS(168)*(U1(27)&
              &*U2(27))+HESS(169)*(U1(27)*U2(29))+HESS(194)*(U1(28)*U2(25))+HESS(195)*(U1(28)*U2(27))+HESS(196)*(U1(28)&
              &*U2(29))+HESS(217)*(U1(29)*U2(29))
    HTU(18) = HESS(65)*(U1(18)*U2(18))+HESS(66)*(U1(18)*U2(31))+HESS(144)*(U1(26)*U2(31))+HESS(237)*(U1(31)*U2(31))
    HTU(19) = HESS(38)*(U1(15)*U2(25))+HESS(44)*(U1(16)*U2(25))+HESS(45)*(U1(16)*U2(27))+HESS(67)*(U1(18)*U2(25))+HESS(68)&
              &*(U1(18)*U2(27))+HESS(81)*(U1(19)*U2(25))+HESS(82)*(U1(19)*U2(27))+HESS(94)*(U1(21)*U2(25))+HESS(95)*(U1(21)&
              &*U2(27))+HESS(118)*(U1(24)*U2(25))+HESS(131)*(U1(25)*U2(25))+HESS(170)*(U1(27)*U2(25))+HESS(171)*(U1(27)&
              &*U2(27))+HESS(197)*(U1(28)*U2(25))+HESS(198)*(U1(28)*U2(27))+HESS(249)*(U1(32)*U2(25))+HESS(250)*(U1(32)&
              &*U2(27))
    HTU(20) = HESS(11)*(U1(8)*U2(27))+HESS(31)*(U1(13)*U2(27))+HESS(69)*(U1(18)*U2(27))+HESS(84)*(U1(20)*U2(27))+HESS(119)&
              &*(U1(24)*U2(27))+HESS(172)*(U1(27)*U2(27))+HESS(199)*(U1(28)*U2(27))
    HTU(21) = HESS(27)*(U1(12)*U2(30))+HESS(46)*(U1(16)*U2(27))+HESS(47)*(U1(16)*U2(29))+HESS(48)*(U1(16)*U2(30))+HESS(96)&
              &*(U1(21)*U2(27))+HESS(97)*(U1(21)*U2(29))+HESS(98)*(U1(21)*U2(30))+HESS(173)*(U1(27)*U2(27))+HESS(174)&
              &*(U1(27)*U2(29))+HESS(200)*(U1(28)*U2(27))+HESS(201)*(U1(28)*U2(29))+HESS(202)*(U1(28)*U2(30))+HESS(218)&
              &*(U1(29)*U2(29))+HESS(226)*(U1(30)*U2(30))
    HTU(22) = HESS(12)*(U1(8)*U2(27))+HESS(13)*(U1(8)*U2(30))+HESS(39)*(U1(15)*U2(25))+HESS(40)*(U1(15)*U2(27))+HESS(49)&
              &*(U1(16)*U2(25))+HESS(50)*(U1(16)*U2(29))+HESS(56)*(U1(17)*U2(25))+HESS(57)*(U1(17)*U2(27))+HESS(58)*(U1(17)&
              &*U2(29))+HESS(70)*(U1(18)*U2(27))+HESS(71)*(U1(18)*U2(29))+HESS(85)*(U1(20)*U2(25))+HESS(86)*(U1(20)*U2(29))&
              &+HESS(99)*(U1(21)*U2(25))+HESS(100)*(U1(21)*U2(27))+HESS(108)*(U1(22)*U2(25))+HESS(109)*(U1(22)*U2(27))&
              &+HESS(110)*(U1(22)*U2(29))+HESS(111)*(U1(22)*U2(30))+HESS(112)*(U1(23)*U2(29))+HESS(120)*(U1(24)*U2(25))&
              &+HESS(121)*(U1(24)*U2(27))+HESS(122)*(U1(24)*U2(29))+HESS(132)*(U1(25)*U2(25))+HESS(175)*(U1(27)*U2(25))&
              &+HESS(176)*(U1(27)*U2(27))+HESS(203)*(U1(28)*U2(25))+HESS(204)*(U1(28)*U2(27))+HESS(205)*(U1(28)*U2(29))&
              &+HESS(219)*(U1(29)*U2(29))+HESS(227)*(U1(30)*U2(30))+HESS(251)*(U1(32)*U2(27))
    HTU(23) = HESS(14)*(U1(8)*U2(29))+HESS(15)*(U1(8)*U2(30))+HESS(51)*(U1(16)*U2(25))+HESS(52)*(U1(16)*U2(29))+HESS(72)&
              &*(U1(18)*U2(25))+HESS(73)*(U1(18)*U2(27))+HESS(74)*(U1(18)*U2(29))+HESS(75)*(U1(18)*U2(30))+HESS(87)*(U1(20)&
              &*U2(25))+HESS(88)*(U1(20)*U2(27))+HESS(89)*(U1(20)*U2(29))+HESS(90)*(U1(20)*U2(30))+HESS(101)*(U1(21)*U2(25))&
              &+HESS(102)*(U1(21)*U2(27))+HESS(103)*(U1(21)*U2(29))+HESS(104)*(U1(21)*U2(30))+HESS(113)*(U1(23)*U2(25))&
              &+HESS(114)*(U1(23)*U2(27))+HESS(115)*(U1(23)*U2(29))+HESS(116)*(U1(23)*U2(30))+HESS(123)*(U1(24)*U2(25))&
              &+HESS(124)*(U1(24)*U2(27))+HESS(125)*(U1(24)*U2(29))+HESS(126)*(U1(24)*U2(30))+HESS(133)*(U1(25)*U2(25))&
              &+HESS(145)*(U1(26)*U2(30))+HESS(177)*(U1(27)*U2(25))+HESS(178)*(U1(27)*U2(27))+HESS(179)*(U1(27)*U2(29))&
              &+HESS(206)*(U1(28)*U2(25))+HESS(207)*(U1(28)*U2(27))+HESS(208)*(U1(28)*U2(29))+HESS(220)*(U1(29)*U2(29))&
              &+HESS(228)*(U1(30)*U2(30))
    HTU(24) = HESS(28)*(U1(12)*U2(30))+HESS(127)*(U1(24)*U2(27))+HESS(128)*(U1(24)*U2(29))+HESS(129)*(U1(24)*U2(30))&
              &+HESS(180)*(U1(27)*U2(27))+HESS(181)*(U1(27)*U2(29))+HESS(221)*(U1(29)*U2(29))+HESS(229)*(U1(30)*U2(30))&
              &+HESS(252)*(U1(32)*U2(27))+HESS(253)*(U1(32)*U2(29))+HESS(254)*(U1(32)*U2(30))
    HTU(25) = HESS(38)*(U1(15)*U2(19))+HESS(39)*(U1(15)*U2(22))+HESS(42)*(U1(16)*U2(17))+HESS(44)*(U1(16)*U2(19))+HESS(49)&
              &*(U1(16)*U2(22))+HESS(51)*(U1(16)*U2(23))+HESS(53)*(U1(17)*U2(17))+HESS(56)*(U1(17)*U2(22))+HESS(67)*(U1(18)&
              &*U2(19))+HESS(72)*(U1(18)*U2(23))+HESS(81)*(U1(19)*U2(19))+HESS(85)*(U1(20)*U2(22))+HESS(87)*(U1(20)*U2(23))&
              &+HESS(91)*(U1(21)*U2(17))+HESS(94)*(U1(21)*U2(19))+HESS(99)*(U1(21)*U2(22))+HESS(101)*(U1(21)*U2(23))&
              &+HESS(108)*(U1(22)*U2(22))+HESS(113)*(U1(23)*U2(23))+HESS(118)*(U1(24)*U2(19))+HESS(120)*(U1(24)*U2(22))&
              &+HESS(123)*(U1(24)*U2(23))+HESS(130)*(U1(25)*U2(17))+HESS(131)*(U1(25)*U2(19))+HESS(132)*(U1(25)*U2(22))&
              &+HESS(133)*(U1(25)*U2(23))+HESS(134)*(U1(25)*U2(26))+HESS(135)*(U1(25)*U2(27))+HESS(136)*(U1(25)*U2(28))&
              &+HESS(137)*(U1(25)*U2(31))+HESS(146)*(U1(26)*U2(26))+HESS(147)*(U1(26)*U2(31))+HESS(170)*(U1(27)*U2(19))&
              &+HESS(175)*(U1(27)*U2(22))+HESS(177)*(U1(27)*U2(23))+HESS(182)*(U1(27)*U2(27))+HESS(183)*(U1(27)*U2(28))&
              &+HESS(194)*(U1(28)*U2(17))+HESS(197)*(U1(28)*U2(19))+HESS(203)*(U1(28)*U2(22))+HESS(206)*(U1(28)*U2(23))&
              &+HESS(209)*(U1(28)*U2(27))+HESS(210)*(U1(28)*U2(28))+HESS(230)*(U1(30)*U2(26))+HESS(238)*(U1(31)*U2(31))&
              &+HESS(249)*(U1(32)*U2(19))
    HTU(26) = HESS(3)*(U1(3)*U2(32))+HESS(4)*(U1(4)*U2(4))+HESS(8)*(U1(6)*U2(30))+HESS(18)*(U1(9)*U2(31))+HESS(21)*(U1(10)&
              &*U2(28))+HESS(29)*(U1(12)*U2(27))+HESS(30)*(U1(13)*U2(13))+HESS(134)*(U1(25)*U2(25))+HESS(138)*(U1(26)*U2(4))&
              &+HESS(143)*(U1(26)*U2(13))+HESS(146)*(U1(26)*U2(25))+HESS(148)*(U1(26)*U2(27))+HESS(149)*(U1(26)*U2(28))&
              &+HESS(150)*(U1(26)*U2(29))+HESS(151)*(U1(26)*U2(30))+HESS(152)*(U1(26)*U2(31))+HESS(153)*(U1(26)*U2(32))&
              &+HESS(184)*(U1(27)*U2(27))+HESS(211)*(U1(28)*U2(28))+HESS(222)*(U1(29)*U2(29))+HESS(230)*(U1(30)*U2(25))&
              &+HESS(231)*(U1(30)*U2(29))+HESS(232)*(U1(30)*U2(30))+HESS(239)*(U1(31)*U2(29))+HESS(240)*(U1(31)*U2(30))&
              &+HESS(241)*(U1(31)*U2(31))+HESS(255)*(U1(32)*U2(32))
    HTU(27) = HESS(1)*(U1(2)*U2(2))+HESS(5)*(U1(4)*U2(14))+HESS(7)*(U1(5)*U2(5))+HESS(9)*(U1(7)*U2(7))+HESS(11)*(U1(8)&
              &*U2(20))+HESS(12)*(U1(8)*U2(22))+HESS(17)*(U1(9)*U2(9))+HESS(19)*(U1(9)*U2(31))+HESS(20)*(U1(10)*U2(10))&
              &+HESS(22)*(U1(11)*U2(5))+HESS(23)*(U1(11)*U2(7))+HESS(25)*(U1(12)*U2(12))+HESS(29)*(U1(12)*U2(26))+HESS(31)&
              &*(U1(13)*U2(20))+HESS(32)*(U1(14)*U2(5))+HESS(33)*(U1(14)*U2(7))+HESS(34)*(U1(14)*U2(14))+HESS(36)*(U1(15)&
              &*U2(7))+HESS(37)*(U1(15)*U2(15))+HESS(40)*(U1(15)*U2(22))+HESS(41)*(U1(16)*U2(16))+HESS(45)*(U1(16)*U2(19))&
              &+HESS(46)*(U1(16)*U2(21))+HESS(54)*(U1(17)*U2(17))+HESS(57)*(U1(17)*U2(22))+HESS(59)*(U1(18)*U2(5))+HESS(60)&
              &*(U1(18)*U2(7))+HESS(61)*(U1(18)*U2(14))+HESS(62)*(U1(18)*U2(15))+HESS(63)*(U1(18)*U2(17))+HESS(68)*(U1(18)&
              &*U2(19))+HESS(69)*(U1(18)*U2(20))+HESS(70)*(U1(18)*U2(22))+HESS(73)*(U1(18)*U2(23))+HESS(80)*(U1(19)*U2(14))&
              &+HESS(82)*(U1(19)*U2(19))+HESS(83)*(U1(20)*U2(7))+HESS(84)*(U1(20)*U2(20))+HESS(88)*(U1(20)*U2(23))+HESS(92)&
              &*(U1(21)*U2(17))+HESS(95)*(U1(21)*U2(19))+HESS(96)*(U1(21)*U2(21))+HESS(100)*(U1(21)*U2(22))+HESS(102)&
              &*(U1(21)*U2(23))+HESS(109)*(U1(22)*U2(22))+HESS(114)*(U1(23)*U2(23))+HESS(117)*(U1(24)*U2(17))+HESS(119)&
              &*(U1(24)*U2(20))+HESS(121)*(U1(24)*U2(22))+HESS(124)*(U1(24)*U2(23))+HESS(127)*(U1(24)*U2(24))+HESS(135)&
              &*(U1(25)*U2(25))+HESS(140)*(U1(26)*U2(9))+HESS(141)*(U1(26)*U2(10))+HESS(148)*(U1(26)*U2(26))+HESS(159)&
              &*(U1(27)*U2(2))+HESS(160)*(U1(27)*U2(5))+HESS(161)*(U1(27)*U2(7))+HESS(162)*(U1(27)*U2(9))+HESS(163)*(U1(27)&
              &*U2(10))+HESS(164)*(U1(27)*U2(12))+HESS(165)*(U1(27)*U2(14))+HESS(166)*(U1(27)*U2(15))+HESS(167)*(U1(27)&
              &*U2(16))+HESS(168)*(U1(27)*U2(17))+HESS(171)*(U1(27)*U2(19))+HESS(172)*(U1(27)*U2(20))+HESS(173)*(U1(27)&
              &*U2(21))+HESS(176)*(U1(27)*U2(22))+HESS(178)*(U1(27)*U2(23))+HESS(180)*(U1(27)*U2(24))+HESS(182)*(U1(27)&
              &*U2(25))+HESS(184)*(U1(27)*U2(26))+HESS(185)*(U1(27)*U2(31))+HESS(188)*(U1(28)*U2(2))+HESS(189)*(U1(28)&
              &*U2(5))+HESS(190)*(U1(28)*U2(7))+HESS(192)*(U1(28)*U2(14))+HESS(193)*(U1(28)*U2(16))+HESS(195)*(U1(28)&
              &*U2(17))+HESS(198)*(U1(28)*U2(19))+HESS(199)*(U1(28)*U2(20))+HESS(200)*(U1(28)*U2(21))+HESS(204)*(U1(28)&
              &*U2(22))+HESS(207)*(U1(28)*U2(23))+HESS(209)*(U1(28)*U2(25))+HESS(224)*(U1(30)*U2(12))+HESS(242)*(U1(31)&
              &*U2(31))+HESS(248)*(U1(32)*U2(15))+HESS(250)*(U1(32)*U2(19))+HESS(251)*(U1(32)*U2(22))+HESS(252)*(U1(32)&
              &*U2(24))
    HTU(28) = HESS(2)*(U1(2)*U2(28))+HESS(21)*(U1(10)*U2(26))+HESS(76)*(U1(18)*U2(32))+HESS(105)*(U1(21)*U2(32))+HESS(136)&
              &*(U1(25)*U2(25))+HESS(149)*(U1(26)*U2(26))+HESS(154)*(U1(26)*U2(31))+HESS(183)*(U1(27)*U2(25))+HESS(186)&
              &*(U1(27)*U2(31))+HESS(187)*(U1(27)*U2(32))+HESS(210)*(U1(28)*U2(25))+HESS(211)*(U1(28)*U2(26))+HESS(212)&
              &*(U1(28)*U2(28))+HESS(213)*(U1(28)*U2(31))+HESS(214)*(U1(28)*U2(32))+HESS(243)*(U1(31)*U2(31))+HESS(256)&
              &*(U1(32)*U2(32))
    HTU(29) = HESS(14)*(U1(8)*U2(23))+HESS(43)*(U1(16)*U2(17))+HESS(47)*(U1(16)*U2(21))+HESS(50)*(U1(16)*U2(22))+HESS(52)&
              &*(U1(16)*U2(23))+HESS(55)*(U1(17)*U2(17))+HESS(58)*(U1(17)*U2(22))+HESS(64)*(U1(18)*U2(17))+HESS(71)*(U1(18)&
              &*U2(22))+HESS(74)*(U1(18)*U2(23))+HESS(86)*(U1(20)*U2(22))+HESS(89)*(U1(20)*U2(23))+HESS(93)*(U1(21)*U2(17))&
              &+HESS(97)*(U1(21)*U2(21))+HESS(103)*(U1(21)*U2(23))+HESS(110)*(U1(22)*U2(22))+HESS(112)*(U1(23)*U2(22))&
              &+HESS(115)*(U1(23)*U2(23))+HESS(122)*(U1(24)*U2(22))+HESS(125)*(U1(24)*U2(23))+HESS(128)*(U1(24)*U2(24))&
              &+HESS(150)*(U1(26)*U2(26))+HESS(155)*(U1(26)*U2(31))+HESS(169)*(U1(27)*U2(17))+HESS(174)*(U1(27)*U2(21))&
              &+HESS(179)*(U1(27)*U2(23))+HESS(181)*(U1(27)*U2(24))+HESS(196)*(U1(28)*U2(17))+HESS(201)*(U1(28)*U2(21))&
              &+HESS(205)*(U1(28)*U2(22))+HESS(208)*(U1(28)*U2(23))+HESS(217)*(U1(29)*U2(17))+HESS(218)*(U1(29)*U2(21))&
              &+HESS(219)*(U1(29)*U2(22))+HESS(220)*(U1(29)*U2(23))+HESS(221)*(U1(29)*U2(24))+HESS(222)*(U1(29)*U2(26))&
              &+HESS(223)*(U1(29)*U2(31))+HESS(231)*(U1(30)*U2(26))+HESS(239)*(U1(31)*U2(26))+HESS(244)*(U1(31)*U2(31))&
              &+HESS(253)*(U1(32)*U2(24))
    HTU(30) = HESS(6)*(U1(4)*U2(14))+HESS(8)*(U1(6)*U2(26))+HESS(13)*(U1(8)*U2(22))+HESS(15)*(U1(8)*U2(23))+HESS(26)&
              &*(U1(12)*U2(14))+HESS(27)*(U1(12)*U2(21))+HESS(28)*(U1(12)*U2(24))+HESS(35)*(U1(14)*U2(14))+HESS(48)*(U1(16)&
              &*U2(21))+HESS(75)*(U1(18)*U2(23))+HESS(90)*(U1(20)*U2(23))+HESS(98)*(U1(21)*U2(21))+HESS(104)*(U1(21)*U2(23))&
              &+HESS(111)*(U1(22)*U2(22))+HESS(116)*(U1(23)*U2(23))+HESS(126)*(U1(24)*U2(23))+HESS(129)*(U1(24)*U2(24))&
              &+HESS(145)*(U1(26)*U2(23))+HESS(151)*(U1(26)*U2(26))+HESS(156)*(U1(26)*U2(31))+HESS(202)*(U1(28)*U2(21))&
              &+HESS(225)*(U1(30)*U2(14))+HESS(226)*(U1(30)*U2(21))+HESS(227)*(U1(30)*U2(22))+HESS(228)*(U1(30)*U2(23))&
              &+HESS(229)*(U1(30)*U2(24))+HESS(232)*(U1(30)*U2(26))+HESS(233)*(U1(30)*U2(31))+HESS(240)*(U1(31)*U2(26))&
              &+HESS(245)*(U1(31)*U2(31))+HESS(254)*(U1(32)*U2(24))
    HTU(31) = HESS(10)*(U1(8)*U2(8))+HESS(18)*(U1(9)*U2(26))+HESS(19)*(U1(9)*U2(27))+HESS(24)*(U1(11)*U2(11))+HESS(66)&
              &*(U1(18)*U2(18))+HESS(77)*(U1(18)*U2(32))+HESS(79)*(U1(19)*U2(11))+HESS(106)*(U1(21)*U2(32))+HESS(137)&
              &*(U1(25)*U2(25))+HESS(142)*(U1(26)*U2(11))+HESS(144)*(U1(26)*U2(18))+HESS(147)*(U1(26)*U2(25))+HESS(152)&
              &*(U1(26)*U2(26))+HESS(154)*(U1(26)*U2(28))+HESS(155)*(U1(26)*U2(29))+HESS(156)*(U1(26)*U2(30))+HESS(157)&
              &*(U1(26)*U2(31))+HESS(158)*(U1(26)*U2(32))+HESS(185)*(U1(27)*U2(27))+HESS(186)*(U1(27)*U2(28))+HESS(191)&
              &*(U1(28)*U2(11))+HESS(213)*(U1(28)*U2(28))+HESS(215)*(U1(28)*U2(32))+HESS(223)*(U1(29)*U2(29))+HESS(233)&
              &*(U1(30)*U2(30))+HESS(234)*(U1(31)*U2(8))+HESS(236)*(U1(31)*U2(11))+HESS(237)*(U1(31)*U2(18))+HESS(238)&
              &*(U1(31)*U2(25))+HESS(241)*(U1(31)*U2(26))+HESS(242)*(U1(31)*U2(27))+HESS(243)*(U1(31)*U2(28))+HESS(244)&
              &*(U1(31)*U2(29))+HESS(245)*(U1(31)*U2(30))+HESS(246)*(U1(31)*U2(31))+HESS(247)*(U1(31)*U2(32))+HESS(257)&
              &*(U1(32)*U2(32))
    HTU(32) = HESS(3)*(U1(3)*U2(26))+HESS(76)*(U1(18)*U2(28))+HESS(77)*(U1(18)*U2(31))+HESS(78)*(U1(18)*U2(32))+HESS(105)&
              &*(U1(21)*U2(28))+HESS(106)*(U1(21)*U2(31))+HESS(107)*(U1(21)*U2(32))+HESS(153)*(U1(26)*U2(26))+HESS(158)&
              &*(U1(26)*U2(31))+HESS(187)*(U1(27)*U2(28))+HESS(214)*(U1(28)*U2(28))+HESS(215)*(U1(28)*U2(31))+HESS(216)&
              &*(U1(28)*U2(32))+HESS(247)*(U1(31)*U2(31))+HESS(255)*(U1(32)*U2(26))+HESS(256)*(U1(32)*U2(28))+HESS(257)&
              &*(U1(32)*U2(31))+HESS(258)*(U1(32)*U2(32))

    END SUBROUTINE CBM4_HessTR_Vec

    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ! 
    ! JacReactantProd - Jacobian of Reactant Products vector
    !   Arguments :
    !      V         - Concentrations of variable species (local)
    !      F         - Concentrations of fixed species (local)
    !      JVRP      - d ARP(1:NREACT)/d VAR (1:NVAR)
    ! 
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    SUBROUTINE JacReactantProd ( V, F, JVRP )

    ! V - Concentrations of variable species (local)
    DOUBLE PRECISION :: V(NVAR)
    ! F - Concentrations of fixed species (local)
    DOUBLE PRECISION :: F(NFIX)
    ! JVRP - d ARP(1:NREACT)/d VAR (1:NVAR)
    DOUBLE PRECISION :: JVRP(NJVRP)

    ! Below we compute the Jacobian of the Reactant Products vector
    !    w.r.t. variable species: d ARP(1:NREACT) / d Var(1:NVAR)

    ! JVRP(1) = dARP(1)/dV(26)
    JVRP(1) = 1
    ! JVRP(2) = dARP(2)/dV(29)
    JVRP(2) = 1
    ! JVRP(3) = dARP(3)/dV(25)
    JVRP(3) = V(31)
    ! JVRP(4) = dARP(3)/dV(31)
    JVRP(4) = V(25)
    ! JVRP(5) = dARP(4)/dV(26)
    JVRP(5) = V(29)
    ! JVRP(6) = dARP(4)/dV(29)
    JVRP(6) = V(26)
    ! JVRP(7) = dARP(5)/dV(26)
    JVRP(7) = V(29)
    ! JVRP(8) = dARP(5)/dV(29)
    JVRP(8) = V(26)
    ! JVRP(9) = dARP(6)/dV(29)
    JVRP(9) = V(31)
    ! JVRP(10) = dARP(6)/dV(31)
    JVRP(10) = V(29)
    ! JVRP(11) = dARP(7)/dV(25)
    JVRP(11) = V(26)
    ! JVRP(12) = dARP(7)/dV(26)
    JVRP(12) = V(25)
    ! JVRP(13) = dARP(8)/dV(25)
    JVRP(13) = 1
    ! JVRP(14) = dARP(9)/dV(25)
    JVRP(14) = 1
    ! JVRP(15) = dARP(10)/dV(1)
    JVRP(15) = 1
    ! JVRP(16) = dARP(11)/dV(1)
    JVRP(16) = F(1)
    ! JVRP(17) = dARP(12)/dV(25)
    JVRP(17) = V(27)
    ! JVRP(18) = dARP(12)/dV(27)
    JVRP(18) = V(25)
    ! JVRP(19) = dARP(13)/dV(25)
    JVRP(19) = V(28)
    ! JVRP(20) = dARP(13)/dV(28)
    JVRP(20) = V(25)
    ! JVRP(21) = dARP(14)/dV(30)
    JVRP(21) = 1
    ! JVRP(22) = dARP(15)/dV(30)
    JVRP(22) = V(31)
    ! JVRP(23) = dARP(15)/dV(31)
    JVRP(23) = V(30)
    ! JVRP(24) = dARP(16)/dV(26)
    JVRP(24) = V(30)
    ! JVRP(25) = dARP(16)/dV(30)
    JVRP(25) = V(26)
    ! JVRP(26) = dARP(17)/dV(26)
    JVRP(26) = V(30)
    ! JVRP(27) = dARP(17)/dV(30)
    JVRP(27) = V(26)
    ! JVRP(28) = dARP(18)/dV(6)
    JVRP(28) = F(1)
    ! JVRP(29) = dARP(19)/dV(6)
    JVRP(29) = 1
    ! JVRP(30) = dARP(20)/dV(31)
    JVRP(30) = 2*V(31)
    ! JVRP(31) = dARP(21)/dV(26)
    JVRP(31) = V(31)*F(1)
    ! JVRP(32) = dARP(21)/dV(31)
    JVRP(32) = V(26)*F(1)
    ! JVRP(33) = dARP(22)/dV(27)
    JVRP(33) = V(31)
    ! JVRP(34) = dARP(22)/dV(31)
    JVRP(34) = V(27)
    ! JVRP(35) = dARP(23)/dV(9)
    JVRP(35) = 1
    ! JVRP(36) = dARP(24)/dV(9)
    JVRP(36) = V(27)
    ! JVRP(37) = dARP(24)/dV(27)
    JVRP(37) = V(9)
    ! JVRP(38) = dARP(25)/dV(9)
    JVRP(38) = 2*V(9)
    ! JVRP(39) = dARP(26)/dV(26)
    JVRP(39) = V(27)
    ! JVRP(40) = dARP(26)/dV(27)
    JVRP(40) = V(26)
    ! JVRP(41) = dARP(27)/dV(12)
    JVRP(41) = V(27)
    ! JVRP(42) = dARP(27)/dV(27)
    JVRP(42) = V(12)
    ! JVRP(43) = dARP(28)/dV(28)
    JVRP(43) = V(31)
    ! JVRP(44) = dARP(28)/dV(31)
    JVRP(44) = V(28)
    ! JVRP(45) = dARP(29)/dV(26)
    JVRP(45) = V(28)
    ! JVRP(46) = dARP(29)/dV(28)
    JVRP(46) = V(26)
    ! JVRP(47) = dARP(30)/dV(10)
    JVRP(47) = 1
    ! JVRP(48) = dARP(31)/dV(10)
    JVRP(48) = V(27)
    ! JVRP(49) = dARP(31)/dV(27)
    JVRP(49) = V(10)
    ! JVRP(50) = dARP(32)/dV(28)
    JVRP(50) = 2*V(28)
    ! JVRP(51) = dARP(33)/dV(28)
    JVRP(51) = 2*V(28)*F(1)
    ! JVRP(52) = dARP(34)/dV(2)
    JVRP(52) = 1
    ! JVRP(53) = dARP(35)/dV(2)
    JVRP(53) = V(27)
    ! JVRP(54) = dARP(35)/dV(27)
    JVRP(54) = V(2)
    ! JVRP(55) = dARP(36)/dV(16)
    JVRP(55) = V(27)
    ! JVRP(56) = dARP(36)/dV(27)
    JVRP(56) = V(16)
    ! JVRP(57) = dARP(37)/dV(21)
    JVRP(57) = V(27)
    ! JVRP(58) = dARP(37)/dV(27)
    JVRP(58) = V(21)
    ! JVRP(59) = dARP(38)/dV(21)
    JVRP(59) = 1
    ! JVRP(60) = dARP(39)/dV(21)
    JVRP(60) = 1
    ! JVRP(61) = dARP(40)/dV(21)
    JVRP(61) = V(29)
    ! JVRP(62) = dARP(40)/dV(29)
    JVRP(62) = V(21)
    ! JVRP(63) = dARP(41)/dV(21)
    JVRP(63) = V(30)
    ! JVRP(64) = dARP(41)/dV(30)
    JVRP(64) = V(21)
    ! JVRP(65) = dARP(42)/dV(24)
    JVRP(65) = V(29)
    ! JVRP(66) = dARP(42)/dV(29)
    JVRP(66) = V(24)
    ! JVRP(67) = dARP(43)/dV(24)
    JVRP(67) = V(27)
    ! JVRP(68) = dARP(43)/dV(27)
    JVRP(68) = V(24)
    ! JVRP(69) = dARP(44)/dV(24)
    JVRP(69) = V(30)
    ! JVRP(70) = dARP(44)/dV(30)
    JVRP(70) = V(24)
    ! JVRP(71) = dARP(45)/dV(24)
    JVRP(71) = 1
    ! JVRP(72) = dARP(46)/dV(31)
    JVRP(72) = V(32)
    ! JVRP(73) = dARP(46)/dV(32)
    JVRP(73) = V(31)
    ! JVRP(74) = dARP(47)/dV(26)
    JVRP(74) = V(32)
    ! JVRP(75) = dARP(47)/dV(32)
    JVRP(75) = V(26)
    ! JVRP(76) = dARP(48)/dV(3)
    JVRP(76) = 1
    ! JVRP(77) = dARP(49)/dV(32)
    JVRP(77) = 2*V(32)
    ! JVRP(78) = dARP(50)/dV(28)
    JVRP(78) = V(32)
    ! JVRP(79) = dARP(50)/dV(32)
    JVRP(79) = V(28)
    ! JVRP(80) = dARP(51)/dV(27)
    JVRP(80) = 1
    ! JVRP(81) = dARP(52)/dV(20)
    JVRP(81) = V(27)
    ! JVRP(82) = dARP(52)/dV(27)
    JVRP(82) = V(20)
    ! JVRP(83) = dARP(53)/dV(13)
    JVRP(83) = 1
    ! JVRP(84) = dARP(54)/dV(13)
    JVRP(84) = 1
    ! JVRP(85) = dARP(55)/dV(13)
    JVRP(85) = V(26)
    ! JVRP(86) = dARP(55)/dV(26)
    JVRP(86) = V(13)
    ! JVRP(87) = dARP(56)/dV(23)
    JVRP(87) = V(29)
    ! JVRP(88) = dARP(56)/dV(29)
    JVRP(88) = V(23)
    ! JVRP(89) = dARP(57)/dV(23)
    JVRP(89) = V(27)
    ! JVRP(90) = dARP(57)/dV(27)
    JVRP(90) = V(23)
    ! JVRP(91) = dARP(58)/dV(23)
    JVRP(91) = V(25)
    ! JVRP(92) = dARP(58)/dV(25)
    JVRP(92) = V(23)
    ! JVRP(93) = dARP(59)/dV(23)
    JVRP(93) = V(30)
    ! JVRP(94) = dARP(59)/dV(30)
    JVRP(94) = V(23)
    ! JVRP(95) = dARP(60)/dV(17)
    JVRP(95) = V(29)
    ! JVRP(96) = dARP(60)/dV(29)
    JVRP(96) = V(17)
    ! JVRP(97) = dARP(61)/dV(17)
    JVRP(97) = V(27)
    ! JVRP(98) = dARP(61)/dV(27)
    JVRP(98) = V(17)
    ! JVRP(99) = dARP(62)/dV(17)
    JVRP(99) = V(25)
    ! JVRP(100) = dARP(62)/dV(25)
    JVRP(100) = V(17)
    ! JVRP(101) = dARP(63)/dV(5)
    JVRP(101) = V(27)
    ! JVRP(102) = dARP(63)/dV(27)
    JVRP(102) = V(5)
    ! JVRP(103) = dARP(64)/dV(11)
    JVRP(103) = V(31)
    ! JVRP(104) = dARP(64)/dV(31)
    JVRP(104) = V(11)
    ! JVRP(105) = dARP(65)/dV(11)
    JVRP(105) = 1
    ! JVRP(106) = dARP(66)/dV(14)
    JVRP(106) = V(27)
    ! JVRP(107) = dARP(66)/dV(27)
    JVRP(107) = V(14)
    ! JVRP(108) = dARP(67)/dV(14)
    JVRP(108) = V(30)
    ! JVRP(109) = dARP(67)/dV(30)
    JVRP(109) = V(14)
    ! JVRP(110) = dARP(68)/dV(4)
    JVRP(110) = V(26)
    ! JVRP(111) = dARP(68)/dV(26)
    JVRP(111) = V(4)
    ! JVRP(112) = dARP(69)/dV(7)
    JVRP(112) = V(27)
    ! JVRP(113) = dARP(69)/dV(27)
    JVRP(113) = V(7)
    ! JVRP(114) = dARP(70)/dV(19)
    JVRP(114) = V(27)
    ! JVRP(115) = dARP(70)/dV(27)
    JVRP(115) = V(19)
    ! JVRP(116) = dARP(71)/dV(19)
    JVRP(116) = 1
    ! JVRP(117) = dARP(72)/dV(19)
    JVRP(117) = V(25)
    ! JVRP(118) = dARP(72)/dV(25)
    JVRP(118) = V(19)
    ! JVRP(119) = dARP(73)/dV(15)
    JVRP(119) = V(27)
    ! JVRP(120) = dARP(73)/dV(27)
    JVRP(120) = V(15)
    ! JVRP(121) = dARP(74)/dV(15)
    JVRP(121) = 1
    ! JVRP(122) = dARP(75)/dV(22)
    JVRP(122) = V(29)
    ! JVRP(123) = dARP(75)/dV(29)
    JVRP(123) = V(22)
    ! JVRP(124) = dARP(76)/dV(22)
    JVRP(124) = V(27)
    ! JVRP(125) = dARP(76)/dV(27)
    JVRP(125) = V(22)
    ! JVRP(126) = dARP(77)/dV(22)
    JVRP(126) = V(25)
    ! JVRP(127) = dARP(77)/dV(25)
    JVRP(127) = V(22)
    ! JVRP(128) = dARP(78)/dV(22)
    JVRP(128) = V(30)
    ! JVRP(129) = dARP(78)/dV(30)
    JVRP(129) = V(22)
    ! JVRP(130) = dARP(79)/dV(18)
    JVRP(130) = V(31)
    ! JVRP(131) = dARP(79)/dV(31)
    JVRP(131) = V(18)
    ! JVRP(132) = dARP(80)/dV(18)
    JVRP(132) = 2*V(18)
    ! JVRP(133) = dARP(81)/dV(8)
    JVRP(133) = V(31)
    ! JVRP(134) = dARP(81)/dV(31)
    JVRP(134) = V(8)
      
    END SUBROUTINE JacReactantProd

    ! End of JacReactantProd function
    ! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



    ! Begin Jacobian Derivative w.r.t. Rate Coefficients

    ! ------------------------------------------------------------------------------
    ! Subroutine for the derivative of Jac with respect to rate coefficients
    ! Times a user vector
    ! -----------------------------------------------------------------------------

    SUBROUTINE  dJac_dRcoeff( V, F, U, NCOEFF, JCOEFF, DJDR )
    IMPLICIT NONE 

    ! V - Concentrations of variable/fixed species            
      DOUBLE PRECISION V(NVAR), F(NFIX)
    ! U - User-supplied Vector           
    DOUBLE PRECISION U(NVAR)
    ! NCOEFF - the number of rate coefficients with respect to which we
    ! differentiate
    INTEGER NCOEFF       
    ! JCOEFF - a vector of integers containing the indices of reactions (rate
    !          coefficients) with respect to which we differentiate
    INTEGER JCOEFF(NCOEFF)       
    ! DFDR  - a matrix containg derivative values; specifically, 
    !         column j contains d Jac(1:NVAR) / d RCT( JCOEFF(j) ) * U
    !                     for each 1 <= j <= NCOEFF
    !         This matrix is stored in a column-wise linearized format
    DOUBLE PRECISION DJDR(NVAR,NCOEFF)

    ! Local vector for Jacobian of reactant products
    DOUBLE PRECISION JV_RPROD(NJVRP)
    DOUBLE PRECISION aj
    INTEGER i,j,k
      
    ! Compute the Jacobian of all reactant products   
    CALL JacReactantProd( V, F, JV_RPROD )

    ! Compute the derivatives by multiplying column JCOEFF(j) of the stoichiometric
    ! matrix with A_PROD       
    DO j=1,NCOEFF
    !                  Initialize the j-th column of derivative matrix to zero       
       DO i=1,NVAR
         DJDR(i,j) = 0.0d0
       END DO
    !                  Column JCOEFF(j) in the stoichiometric matrix times the
    !                  ( Gradient of reactant product of the JCOEFF(j)-th reaction X
    !                  user vector )    
    !                  give the j-th column of the derivative matrix   
    !
    !          Row JCOEFF(j) of JV_RPROD times the user vector
         aj = 0.0d0
       DO k=CROW_JVRP(JCOEFF(j)),CROW_JVRP(JCOEFF(j)+1)-1
         aj = aj + JV_RPROD(k)*U(ICOL_JVRP(k))
       END DO
    !         Column JCOEFF(j) of Stoichiom. matrix times aj         
       DO k=CCOL_STOICM(JCOEFF(j)),CCOL_STOICM(JCOEFF(j)+1)-1
         DJDR(IROW_STOICM(k),j) = STOICM(k)*aj
       END DO
    END DO
      
    END SUBROUTINE  dJac_dRcoeff

    ! End Jacobian Derivative w.r.t. Rate Coefficients


    ! End Derivative w.r.t. Rate Coefficients

    !~~~> Simplified Arrhenius, with two arguments
    !~~~> Note: The argument B0 has a changed sign when compared to ARR
    DOUBLE PRECISION FUNCTION ARR2(A0,B0 )
    DOUBLE PRECISION :: A0,B0
    ARR2 =  DBLE(A0) * EXP( DBLE(B0)/TEMP )
    END FUNCTION ARR2

END MODULE
